<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>vue3快速上手 | 孙文祥的博客</title><meta name="keywords" content="前端,Vue,Vue3"><meta name="author" content="Sun wen xiang"><meta name="copyright" content="Sun wen xiang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="介绍Vue3简介   2020年9月18日，Vue.js发布3.0版本，代号：One Piece（海贼王）  Vue3带来了什么源码的升级 使用Proxy代替defineProperty实现响应式  重写虚拟DOM的实现和Tree-Shaking ……   新的特性 Composition API（组合API）  setup配置 ref与reactive watch与watchEffect pro">
<meta property="og:type" content="article">
<meta property="og:title" content="vue3快速上手">
<meta property="og:url" content="http://example.com/2022/07/21/vue3%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/index.html">
<meta property="og:site_name" content="孙文祥的博客">
<meta property="og:description" content="介绍Vue3简介   2020年9月18日，Vue.js发布3.0版本，代号：One Piece（海贼王）  Vue3带来了什么源码的升级 使用Proxy代替defineProperty实现响应式  重写虚拟DOM的实现和Tree-Shaking ……   新的特性 Composition API（组合API）  setup配置 ref与reactive watch与watchEffect pro">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tu.sunning.fit/i/y/92.jpg">
<meta property="article:published_time" content="2022-07-21T00:43:02.000Z">
<meta property="article:modified_time" content="2022-07-21T00:43:02.000Z">
<meta property="article:author" content="Sun wen xiang">
<meta property="article:tag" content="前端">
<meta property="article:tag" content="Vue">
<meta property="article:tag" content="Vue3">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tu.sunning.fit/i/y/92.jpg"><link rel="shortcut icon" href="/img/touxiang.png"><link rel="canonical" href="http://example.com/2022/07/21/vue3%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'vue3快速上手',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-07-21 08:43:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/touxiang.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">69</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tu.sunning.fit/i/y/92.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">孙文祥的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">vue3快速上手</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-07-21T00:43:02.000Z" title="发表于 2022-07-21 08:43:02">2022-07-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-21T00:43:02.000Z" title="更新于 2022-07-21 08:43:02">2022-07-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">15.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>64分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="vue3快速上手"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><h2 id="Vue3简介"><a href="#Vue3简介" class="headerlink" title="Vue3简介"></a>Vue3简介</h2><img src="https://tu.sunning.fit/i/2022/05/30/6294580d1760e.png" style="width:200px" />

<ul>
<li>2020年9月18日，Vue.js发布3.0版本，代号：One Piece（海贼王）</li>
</ul>
<h2 id="Vue3带来了什么"><a href="#Vue3带来了什么" class="headerlink" title="Vue3带来了什么"></a>Vue3带来了什么</h2><h3 id="源码的升级"><a href="#源码的升级" class="headerlink" title="源码的升级"></a>源码的升级</h3><ul>
<li><p>使用Proxy代替defineProperty实现响应式</p>
</li>
<li><p>重写虚拟DOM的实现和Tree-Shaking</p>
<p>……</p>
</li>
</ul>
<h3 id="新的特性"><a href="#新的特性" class="headerlink" title="新的特性"></a>新的特性</h3><ol>
<li><p>Composition API（组合API）</p>
<ul>
<li>setup配置</li>
<li>ref与reactive</li>
<li>watch与watchEffect</li>
<li>provide与inject</li>
<li>……</li>
</ul>
</li>
<li><p>新的内置组件</p>
<ul>
<li>Fragment </li>
<li>Teleport</li>
<li>Suspense</li>
</ul>
</li>
<li><p>其他改变</p>
<ul>
<li>新的生命周期钩子</li>
<li>data 选项应始终被声明为一个函数</li>
<li>移除keyCode支持作为 v-on 的修饰符</li>
<li>……</li>
</ul>
</li>
</ol>
<h1 id="创建Vue3-0工程"><a href="#创建Vue3-0工程" class="headerlink" title="创建Vue3.0工程"></a>创建Vue3.0工程</h1><h2 id="使用-vue-cli-创建"><a href="#使用-vue-cli-创建" class="headerlink" title="使用 vue-cli 创建"></a>使用 vue-cli 创建</h2><p>官方文档：<a target="_blank" rel="noopener" href="https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create">https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span></span><br><span class="line">vue --version</span><br><span class="line"><span class="comment">## 安装或者升级你的@vue/cli</span></span><br><span class="line">npm install -g @vue/cli</span><br><span class="line"><span class="comment">## 创建</span></span><br><span class="line">vue create vue_test</span><br><span class="line"><span class="comment">## 启动</span></span><br><span class="line"><span class="built_in">cd</span> vue_test</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure>

<h2 id="使用-vite-创建"><a href="#使用-vite-创建" class="headerlink" title="使用 vite 创建"></a>使用 vite 创建</h2><p>官方文档：<a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/installation.html#vite">https://v3.cn.vuejs.org/guide/installation.html#vite</a></p>
<p>vite官网：<a target="_blank" rel="noopener" href="https://vitejs.cn/">https://vitejs.cn</a></p>
<ul>
<li>什么是vite？—— 新一代前端构建工具。</li>
<li>优势如下：<ul>
<li>开发环境中，无需打包操作，可快速的冷启动。</li>
<li>轻量快速的热重载（HMR）。</li>
<li>真正的按需编译，不再等待整个应用编译完成。</li>
</ul>
</li>
<li>传统构建 与 vite构建对比图</li>
</ul>
<p><img src="https://tu.sunning.fit/i/2022/05/30/62945814f0458.png" style="width:500px;height:280px;float:left" /><img src="https://tu.sunning.fit/i/2022/05/30/6294581a7a104.png" style="width:480px;height:280px" /></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">## 创建工程</span></span><br><span class="line">npm init vite-app &lt;project-name&gt;</span><br><span class="line"><span class="comment">## 进入工程目录</span></span><br><span class="line"><span class="built_in">cd</span> &lt;project-name&gt;</span><br><span class="line"><span class="comment">## 安装依赖</span></span><br><span class="line">npm install</span><br><span class="line"><span class="comment">## 运行</span></span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure>

<h2 id="一开始"><a href="#一开始" class="headerlink" title="一开始"></a>一开始</h2><h3 id="html-body-app的设置"><a href="#html-body-app的设置" class="headerlink" title="html,body,#app的设置"></a>html,body,#app的设置</h3><p>在app.vue里面</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span>, <span class="selector-tag">body</span>, <span class="selector-id">#app</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="css清除默认样式"><a href="#css清除默认样式" class="headerlink" title="css清除默认样式"></a>css清除默认样式</h3><p>assets里面建一个css文件夹，然后resert.less，引入在<code>main.ts</code>里面进行引入</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* http://meyerweb.com/eric/tools/css/reset/</span></span><br><span class="line"><span class="comment">   v2.0 | 20110126</span></span><br><span class="line"><span class="comment">   License: none (public domain)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">html</span>, <span class="selector-tag">body</span>, <span class="selector-tag">div</span>, <span class="selector-tag">span</span>, <span class="selector-tag">applet</span>, <span class="selector-tag">object</span>, <span class="selector-tag">iframe</span>,</span><br><span class="line"><span class="selector-tag">h1</span>, <span class="selector-tag">h2</span>, <span class="selector-tag">h3</span>, <span class="selector-tag">h4</span>, <span class="selector-tag">h5</span>, <span class="selector-tag">h6</span>, <span class="selector-tag">p</span>, <span class="selector-tag">blockquote</span>, <span class="selector-tag">pre</span>,</span><br><span class="line"><span class="selector-tag">a</span>, <span class="selector-tag">abbr</span>, <span class="selector-tag">acronym</span>, <span class="selector-tag">address</span>, <span class="selector-tag">big</span>, <span class="selector-tag">cite</span>, <span class="selector-tag">code</span>,</span><br><span class="line"><span class="selector-tag">del</span>, <span class="selector-tag">dfn</span>, <span class="selector-tag">em</span>, <span class="selector-tag">img</span>, <span class="selector-tag">ins</span>, <span class="selector-tag">kbd</span>, <span class="selector-tag">q</span>, <span class="selector-tag">s</span>, <span class="selector-tag">samp</span>,</span><br><span class="line"><span class="selector-tag">small</span>, <span class="selector-tag">strike</span>, <span class="selector-tag">strong</span>, <span class="selector-tag">sub</span>, <span class="selector-tag">sup</span>, <span class="selector-tag">tt</span>, <span class="selector-tag">var</span>,</span><br><span class="line"><span class="selector-tag">b</span>, <span class="selector-tag">u</span>, <span class="selector-tag">i</span>, <span class="selector-tag">center</span>,</span><br><span class="line"><span class="selector-tag">dl</span>, <span class="selector-tag">dt</span>, <span class="selector-tag">dd</span>, <span class="selector-tag">ol</span>, <span class="selector-tag">ul</span>, <span class="selector-tag">li</span>,</span><br><span class="line"><span class="selector-tag">fieldset</span>, <span class="selector-tag">form</span>, <span class="selector-tag">label</span>, <span class="selector-tag">legend</span>,</span><br><span class="line"><span class="selector-tag">table</span>, <span class="selector-tag">caption</span>, <span class="selector-tag">tbody</span>, <span class="selector-tag">tfoot</span>, <span class="selector-tag">thead</span>, <span class="selector-tag">tr</span>, <span class="selector-tag">th</span>, <span class="selector-tag">td</span>,</span><br><span class="line"><span class="selector-tag">article</span>, <span class="selector-tag">aside</span>, <span class="selector-tag">canvas</span>, <span class="selector-tag">details</span>, <span class="selector-tag">embed</span>,</span><br><span class="line"><span class="selector-tag">figure</span>, <span class="selector-tag">figcaption</span>, <span class="selector-tag">footer</span>, <span class="selector-tag">header</span>, <span class="selector-tag">hgroup</span>,</span><br><span class="line"><span class="selector-tag">menu</span>, <span class="selector-tag">nav</span>, <span class="selector-tag">output</span>, <span class="selector-tag">ruby</span>, <span class="selector-tag">section</span>, <span class="selector-tag">summary</span>,</span><br><span class="line"><span class="selector-tag">time</span>, <span class="selector-tag">mark</span>, <span class="selector-tag">audio</span>, <span class="selector-tag">video</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">font</span>: inherit;</span><br><span class="line">  <span class="attribute">vertical-align</span>: baseline;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* HTML5 display-role reset for older browsers */</span></span><br><span class="line"><span class="selector-tag">article</span>, <span class="selector-tag">aside</span>, <span class="selector-tag">details</span>, <span class="selector-tag">figcaption</span>, <span class="selector-tag">figure</span>,</span><br><span class="line"><span class="selector-tag">footer</span>, <span class="selector-tag">header</span>, <span class="selector-tag">hgroup</span>, <span class="selector-tag">menu</span>, <span class="selector-tag">nav</span>, <span class="selector-tag">section</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">ol</span>, <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">blockquote</span>, <span class="selector-tag">q</span> &#123;</span><br><span class="line">  <span class="attribute">quotes</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">blockquote</span><span class="selector-pseudo">:before</span>, <span class="selector-tag">blockquote</span><span class="selector-pseudo">:after</span>,</span><br><span class="line"><span class="selector-tag">q</span><span class="selector-pseudo">:before</span>, <span class="selector-tag">q</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">content</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">table</span> &#123;</span><br><span class="line">  <span class="attribute">border-collapse</span>: collapse;</span><br><span class="line">  <span class="attribute">border-spacing</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="工程结构分析"><a href="#工程结构分析" class="headerlink" title="工程结构分析"></a>工程结构分析</h1><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//引入的不再是Vue构造函数了，引入的是createApp的工厂函数(工厂函数不用new了，直接调用就会给一个)</span></span><br><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建了应用实例对象——app （类似之前vue2中的vm,但app更轻量（没有用不到的方法和属性了））</span></span><br><span class="line"><span class="title function_">createAPP</span>(<span class="title class_">App</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://tu.sunning.fit/i/2022/05/30/62945820e18a5.png" alt="image-20220530012437060"></p>
<h1 id="vue指令"><a href="#vue指令" class="headerlink" title="vue指令"></a>vue指令</h1><p>v-text 用来显示文本</p>
<p>v-html 用来展示富文本  就是可以接受html的语法</p>
<p>v-if 用来控制元素的显示隐藏（切换真假DOM）</p>
<p>v-else-if 表示 v-if 的“else if 块”。可以链式调用</p>
<p>v-else v-if条件收尾语句</p>
<p>v-show 用来控制元素的显示隐藏（display none block Css切换）</p>
<p>v-on 简写@ 用来给元素添加事件</p>
<p>v-bind 简写:  用来绑定元素的属性Attr （默认的是读取不了script里面的内容的，加上: 就可以了</p>
<p>v-model 双向绑定  没弄双向绑定之前，数据只能从script流向页面，但是页面的数据不能流回页面，但是vue3还需要ref来变成响应式，vue不把所有的东西都作为响应式了，只有定义了ref的才是响应式</p>
<p>v-for 用来遍历元素</p>
<p>v-on修饰符 冒泡案例</p>
<h2 id="v-show-vs-v-if"><a href="#v-show-vs-v-if" class="headerlink" title="v-show vs v-if"></a>v-show vs v-if</h2><p>v-show是通过css显示隐藏，v-if是直接不渲染了，频繁切换用v-show</p>
<h2 id="添加事件"><a href="#添加事件" class="headerlink" title="@ 添加事件"></a>@ 添加事件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div @click=&quot;parent&quot;&gt;</span><br><span class="line">      	&lt;button @click.stop=&quot;xxxx&quot;/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>默认是冒泡的，从子对象的事件到父对象的事件</p>
<p>如果想要阻止冒泡，加上个stop即可</p>
<p>想要阻止默认事件： <code>@click.prevent</code>即可</p>
<h2 id="方便地控制哪个css被渲染"><a href="#方便地控制哪个css被渲染" class="headerlink" title="方便地控制哪个css被渲染"></a>方便地控制哪个css被渲染</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;cls&quot;</span>&gt;</span> 123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">type <span class="title class_">Cls</span> = &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">a</span>: boolean,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">b</span>: boolean</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> <span class="attr">cls</span>:<span class="title class_">Cls</span>=&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">a</span>:<span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">b</span>:<span class="literal">false</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.a</span>&#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">color</span>: red;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.b</span>&#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h2 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h2><p><strong>在Vue3 v-model 是破坏性更新:就是和vue2不兼容了</strong></p>
<p>v-model 其实是一个语法糖 通过props 和 emit组合而成的</p>
<p>默认值的改变:</p>
<ul>
<li>prop：value -&gt; modelValue；</li>
<li>事件：input -&gt; update:modelValue；</li>
<li>v-bind 的 .sync 修饰符和组件的 model 选项已移除</li>
<li>新增 支持多个v-model</li>
<li>新增 支持自定义 修饰符</li>
</ul>
<h3 id="自定义修饰符："><a href="#自定义修饰符：" class="headerlink" title="自定义修饰符："></a>自定义修饰符：</h3><p>添加到组件v-model的修饰符将通过modelModifiers prop提供给组件</p>
<p>父A</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">B</span> <span class="attr">v-model:title.aaa</span>=<span class="string">&#x27;xxx&#x27;</span> <span class="attr">v-model.xiaoman</span>=<span class="string">&#x27;xxx&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>子B</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span>=&#123;</span><br><span class="line">    modelModifiers?:&#123;</span><br><span class="line">        <span class="attr">xiaomain</span>:<span class="built_in">boolean</span></span><br><span class="line">    &#125;</span><br><span class="line">    titleModifiers&#123;   <span class="comment">//title就是v-model:title.aaa 绑定上的那个aaa</span></span><br><span class="line">    	<span class="attr">aaa</span>:<span class="built_in">boolean</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">PropsData</span>=defineProps&lt;<span class="title class_">Props</span>&gt;()</span><br><span class="line"><span class="keyword">if</span>(<span class="title class_">PropsData</span>.<span class="property">titleModifiers</span>?.<span class="property">aaa</span>)&#123;</span><br><span class="line">    xxxxxxx</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="directive自定义指令"><a href="#directive自定义指令" class="headerlink" title="directive自定义指令"></a>directive自定义指令</h2><p><strong>破坏性更新：和vue2不兼容</strong></p>
<h1 id="常用-Composition-API-组合式API"><a href="#常用-Composition-API-组合式API" class="headerlink" title="常用 Composition API (组合式API)"></a>常用 Composition API (组合式API)</h1><p>都是函数</p>
<p>官方文档: <a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/composition-api-introduction.html">https://v3.cn.vuejs.org/guide/composition-api-introduction.html</a></p>
<h2 id="拉开序幕的setup"><a href="#拉开序幕的setup" class="headerlink" title="拉开序幕的setup"></a>拉开序幕的setup</h2><ol>
<li><p>理解：Vue3.2中一个新的配置项，值为一个函数。</p>
</li>
<li><p>setup是所有<strong style="color:#DD5145">Composition API（组合API）</strong><i style="color:gray;font-weight:bold">“ 表演的舞台 ”</i>。</p>
</li>
<li><p>组件中所用到的：数据、方法等等，均要配置在setup中，所有的计算属性，生命周期巴拉巴拉都写在setup里面</p>
</li>
<li><p>setup函数的两种返回值：</p>
<ol>
<li><p>若返回一个对象，则对象中的属性、方法, 在模板中均可以直接使用。（重点关注！）</p>
</li>
<li><p><span style="color:#aad">若返回一个渲染函数：则可以自定义渲染内容。（了解）</span></p>
<blockquote>
<p>在script里面要先引入h渲染函数</p>
<p>h(  xxx ,xxxx )  xxx是调用哪一种元素，xxxx是这种元素的内容</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="function">()=&gt;</span>&#123;<span class="keyword">return</span> <span class="title function_">h</span>(<span class="string">&#x27;h1&#x27;</span>,<span class="string">&#x27;上硅谷&#x27;</span>)&#125;</span><br></pre></td></tr></table></figure>


<p>简化的写法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="title function_">h</span>(<span class="string">&#x27;h1&#x27;</span>, <span class="string">&#x27;上硅谷&#x27;</span>);</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">import</span> &#123;h&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;IndexPage&#x27;</span>,</span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line"> <span class="keyword">const</span> test=<span class="string">&quot;123&quot;</span></span><br><span class="line"> <span class="keyword">return</span> &#123;</span><br><span class="line">     test,</span><br><span class="line">     <span class="function">() =&gt;</span> <span class="title function_">h</span>(<span class="string">&#x27;h1&#x27;</span>, <span class="string">&#x27;上硅谷&#x27;</span>);  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>h渲染函数，想要把哪种元素渲染到哪个位置 上面是把’上硅谷’渲染到h1上，然后templete里面写的东西就都不用了，全被渲染函数替换掉了</p>
<p>需要把渲染的结果返回，所以完全体是这样的<code>() =&gt;&#123; return  h(&#39;h1&#39;, &#39;上硅谷&#39;)&#125;</code></p>
</blockquote>
</li>
</ol>
<p>在setup里面的变量在setup里面可以随意使用</p>
<p>要在外面使用的东西要有return的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> mname = <span class="number">123</span>;</span><br><span class="line">    <span class="keyword">let</span> mage = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">`name <span class="subst">$&#123;mname&#125;</span> age <span class="subst">$&#123;mage&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      mname,</span><br><span class="line">      mage,</span><br><span class="line">      test,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p>注意点：</p>
<ol>
<li>尽量不要与Vue2.x配置混用<ul>
<li>Vue2.x配置（data、methos、computed…）中<strong style="color:#DD5145">可以访问到</strong>setup中的属性、方法。</li>
<li>但在setup中<strong style="color:#DD5145">不能访问到</strong>Vue2.x配置（data、methos、computed…）。</li>
<li>如果有重名, setup优先。</li>
</ul>
</li>
<li>setup不能是一个async函数，因为返回值不再是return的对象, 而是promise, 模板看不到return对象中的属性。（后期也可以返回一个Promise实例，<strong>但需要Suspense和异步组件的配合</strong>(见下面Suspense笔记)）</li>
</ol>
</li>
</ol>
<h2 id="ref函数"><a href="#ref函数" class="headerlink" title="ref函数"></a>ref函数</h2><blockquote>
<p>vue2中的ref作用</p>
<p>为了选择到某个东西</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">    &lt;navbar ref=&quot;navbar&quot;&gt;&lt;/navbar&gt;</span><br><span class="line">    &lt;pagefooter ref=&quot;pagefooter&quot;&gt;&lt;/pagefooter&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">new Vue(&#123;</span><br><span class="line">  el:&#x27;#app&#x27;,</span><br><span class="line">  mounted:function () &#123;</span><br><span class="line">    //ready,</span><br><span class="line">    //这里怎么直接访问navbar的navs和pagefooter的footer值呢，</span><br><span class="line">    console.log(this.$refs.navbar.navs);</span><br><span class="line">    console.log(this.$refs.pagefooter.footer);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>


<p>就相当于是方便读取数据</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;div ref=<span class="string">&quot;demo&quot;</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">demo</span>和 <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;[ref=demo]&#x27;</span>);作用一样</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><p>作用: 定义一个响应式的数据</p>
</li>
<li><p>语法: <code>const xxx = ref(initValue)</code> </p>
<ul>
<li>创建一个包含响应式数据的<strong style="color:#DD5145">引用对象（reference对象，简称ref对象）</strong>。</li>
<li>这样会把上面的initValue属性加工成RefImpl对象, reference(引用) implement（实现）    这个的全称是引用实现的实例对象——引用对象<br><img src="https://tu.sunning.fit/i/2022/05/30/62945829c7ce0.png" alt="image-20220530133705520"></li>
</ul>
<p>把get,set方法都放到原型对象上面去了,需要访问这个引用对象，访问的是它的value值</p>
<p><img src="https://tu.sunning.fit/i/2022/07/06/62c54691e1792.png" alt="image-20220530134558541"></p>
<p>如果需要响应式的是一个对象</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> job=<span class="title function_">ref</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>:xxx,</span><br><span class="line">    <span class="attr">salary</span>:xxx,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><img src="https://tu.sunning.fit/i/2022/07/06/62c54696a9ab2.png" alt="image-20220530135402225"></p>
<p>变成的是一个proxy对象（es6的，windows上面自带的）</p>
<p>这时候访问就是  job.value.salary了</p>
<ul>
<li>JS中操作数据： <code>xxx.value</code></li>
<li>模板中读取数据: 不需要.value，直接：<code>&lt;div&gt;&#123;&#123;xxx&#125;&#125;&lt;/div&gt;</code></li>
</ul>
</li>
<li><p>备注：</p>
<ul>
<li>接收的数据可以是：基本类型、也可以是对象类型。</li>
<li>基本类型的数据：响应式依然是靠<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>完成的。</li>
<li>对象类型的数据：内部 <i style="color:gray;font-weight:bold">“ 求助 ”</i> 了Vue3.0中的一个新函数—— <code>reactive</code>函数（用的是proxy）。</li>
</ul>
</li>
</ul>
<h3 id="isRef"><a href="#isRef" class="headerlink" title="isRef"></a>isRef</h3><p>判断是不是一个ref对象</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ref, <span class="title class_">Ref</span>,isRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">let</span> <span class="attr">message</span>: <span class="title class_">Ref</span>&lt;<span class="built_in">string</span> | <span class="built_in">number</span>&gt; = <span class="title function_">ref</span>(<span class="string">&quot;我是message&quot;</span>)</span><br><span class="line"><span class="keyword">let</span> <span class="attr">notRef</span>:<span class="built_in">number</span> = <span class="number">123</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeMsg</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  message.<span class="property">value</span> = <span class="string">&quot;change msg&quot;</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isRef</span>(message)); <span class="comment">//true</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">isRef</span>(notRef)); <span class="comment">//false</span></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="shallowRef"><a href="#shallowRef" class="headerlink" title="shallowRef"></a>shallowRef</h3><p>创建一个跟踪自身.value变化的ref,但不会把其值也变成响应式的（浅响应式）</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Ref</span>, shallowRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Obj</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">message</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">Obj</span>&gt; = <span class="title function_">shallowRef</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;小满&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeMsg</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  message.<span class="property">value</span>.<span class="property">name</span> = <span class="string">&#x27;大满&#x27;</span> <span class="comment">//改name不会去相应，改value会做出相应</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="shallowRef视图更新的问题"><a href="#shallowRef视图更新的问题" class="headerlink" title="shallowRef视图更新的问题"></a>shallowRef视图更新的问题</h4><p><img src="https://tu.sunning.fit/i/2022/07/14/62d021c2e43ed.png" alt="image-20220714220136008"></p>
<p>在change里面如果更改一个ref对象的话，虽然msg是shallowRef,但是也会出发msg的更新，因为源码里面最后都会调用triggerRefavlue,然后把shallowRef的值也一并更新了</p>
<h3 id="triggerRef"><a href="#triggerRef" class="headerlink" title="triggerRef"></a>triggerRef</h3><p>强制更新页面dom</p>
<p>常和shallowRef打配合</p>
<p>改完值之后，强制更新一下</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Ref</span>, shallowRef,triggerRef &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Obj</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">message</span>: <span class="title class_">Ref</span>&lt;<span class="title class_">Obj</span>&gt; = <span class="title function_">shallowRef</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;小满&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="title function_">changeMsg</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  message.<span class="property">value</span>.<span class="property">name</span> = <span class="string">&#x27;大满&#x27;</span></span><br><span class="line"> <span class="title function_">triggerRef</span>(message)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="customRef"><a href="#customRef" class="headerlink" title="customRef"></a>customRef</h3><p>自定义ref</p>
<p>customRef是个工厂函数返回一个对象，并且实现get和set</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title class_">Myref</span>&lt;T&gt;(<span class="attr">value</span>:T)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">customRef</span>(<span class="function">(<span class="params">track,trigger</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            <span class="title function_">get</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">track</span>();</span><br><span class="line">                <span class="keyword">return</span> vlue;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="title function_">set</span>(<span class="params">newVal:T</span>)&#123;</span><br><span class="line">                value=newVal;</span><br><span class="line">                <span class="title function_">trigger</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> message=<span class="title class_">Myref</span>(<span class="string">&#x27;123&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="reactive函数"><a href="#reactive函数" class="headerlink" title="reactive函数"></a>reactive函数</h2><ul>
<li>作用: 定义一个<strong style="color:#DD5145">对象类型</strong>的响应式数据（基本类型不要用它，要用<code>ref</code>函数）</li>
<li>语法：<code>const 代理对象= reactive(源对象)</code>接收一个对象（或数组），返回一个<strong style="color:#DD5145">代理对象（Proxy的实例对象，简称proxy对象）</strong></li>
<li>reactive定义的响应式数据是“深层次的”。</li>
<li>内部基于 ES6 的 Proxy 实现，通过代理对象操作源对象内部数据进行操作。</li>
</ul>
<h3 id="数组异步赋值问题"><a href="#数组异步赋值问题" class="headerlink" title="数组异步赋值问题"></a>数组异步赋值问题</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person=reactive&lt;<span class="built_in">number</span>[]&gt;([]);</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    person=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">&#125;,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>这样页面不会变化，因为脱离了响应式</p>
<h4 id="解决一"><a href="#解决一" class="headerlink" title="解决一"></a>解决一</h4><p>使用push</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    person.<span class="title function_">push</span>(...arr);</span><br><span class="line">&#125;,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<h4 id="解决二"><a href="#解决二" class="headerlink" title="解决二"></a>解决二</h4><p>包裹一层对象</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Person</span>=&#123;</span><br><span class="line">    list?:<span class="title class_">Array</span>&lt;<span class="built_in">number</span>&gt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> person=reactive&lt;<span class="title class_">Person</span>&gt;(&#123;</span><br><span class="line">    <span class="attr">list</span>:[]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    person.<span class="property">list</span>=arr;</span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>



<h3 id="readonly"><a href="#readonly" class="headerlink" title="readonly"></a>readonly</h3><p>拷贝一份proxy对象将其设置为只读</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">拷贝一份proxy对象将其设置为只读</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; reactive ,<span class="keyword">readonly</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> person = <span class="title function_">reactive</span>(&#123;<span class="attr">count</span>:<span class="number">1</span>&#125;)</span><br><span class="line"><span class="keyword">const</span> copy = <span class="title function_">readonly</span>(person)</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//person.count++</span></span><br><span class="line"> </span><br><span class="line"> copy.<span class="property">count</span>++</span><br></pre></td></tr></table></figure>



<h3 id="shallowReactive"><a href="#shallowReactive" class="headerlink" title="shallowReactive"></a>shallowReactive</h3><p>只能对浅层的数据，如果是深层的数据只会改变值，不会改变视图</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,  <span class="comment">//可以监视到改变</span></span><br><span class="line">  <span class="attr">first</span>: &#123;</span><br><span class="line">    <span class="attr">b</span>: <span class="number">2</span>,   <span class="comment">//深层的改变监视不到了</span></span><br><span class="line">    <span class="attr">second</span>: &#123;</span><br><span class="line">      <span class="attr">c</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">shallowReactive</span>(obj)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">change1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  state.<span class="property">a</span> = <span class="number">7</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">change2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  state.<span class="property">first</span>.<span class="property">b</span> = <span class="number">8</span></span><br><span class="line">  state.<span class="property">first</span>.<span class="property">second</span>.<span class="property">c</span> = <span class="number">9</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(state);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">change1</span>();</span><br><span class="line"><span class="title function_">change2</span>(); <span class="comment">//如果直接写在这里，vue还没开始绑定，这时候对数据的操作是会改变数值的</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>绑定之后才是浅层reactive,没绑定之前对数据的操作是会改变的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div&gt;&#123;&#123; state &#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;button @click=&quot;change1&quot;&gt;test1&lt;/button&gt;</span><br><span class="line">    &lt;button @click=&quot;change2&quot;&gt;test2&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>在这用按钮触发的才会是shallowReactive</p>
<h2 id="to全家桶"><a href="#to全家桶" class="headerlink" title="to全家桶"></a>to全家桶</h2><h3 id="toRef"><a href="#toRef" class="headerlink" title="toRef"></a>toRef</h3><p>如果原始对象是非响应式的就不会更新视图，数据是会变的，但如果引用的原始数据就是响应式的是会改变视图的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">      &lt;button @click=&quot;change&quot;&gt;按钮&lt;/button&gt;</span><br><span class="line">      &#123;&#123;state&#125;&#125;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; reactive, toRef &#125; from &#x27;vue&#x27;</span><br><span class="line"> </span><br><span class="line">const obj = &#123;</span><br><span class="line">   foo: 1,</span><br><span class="line">   bar: 1</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">const state = toRef(obj, &#x27;bar&#x27;)</span><br><span class="line">// bar 转化为响应式对象</span><br><span class="line"> </span><br><span class="line">const change = () =&gt; &#123;</span><br><span class="line">   state.value++   //对state操作，obj中的bar是会改变的，但是不会更新在页面中</span><br><span class="line">   console.log(obj, state);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>toRef和ref区别：</strong></p>
<p>相同： <code>ref</code>可以用于创建一个响应式数据，而<code>toRef</code>也可以创建一个响应式数据<br>如果利用<code>ref</code>函数将某个对象中的属性变成响应式数据，修改响应式数据是不会影响到原始数据。</p>
<p>而使用toRef将每个对象中的属性变成响应式数据，修改响应式是会影响到原始数据的</p>
<p>原因：ref本质是拷贝，和原始数据引用没有关系，toRef本质是引用，与原始数据有关联</p>
</blockquote>
<h3 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs"></a>toRefs</h3><p>帮我们批量创建ref对象，主要是方便我们解构使用</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; reactive, toRefs &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">   <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">   <span class="attr">bar</span>: <span class="number">1</span></span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">let</span> &#123; foo, bar &#125; = <span class="title function_">toRefs</span>(obj) <span class="comment">//这样foo和bar都是响应式的了</span></span><br><span class="line"> </span><br><span class="line">foo.<span class="property">value</span>++</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo, bar);</span><br></pre></td></tr></table></figure>



<h3 id="toRaw"><a href="#toRaw" class="headerlink" title="toRaw"></a>toRaw</h3><p>把响应式对象变成普通对象</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="title function_">reactive</span>(&#123;  <span class="comment">//响应式的</span></span><br><span class="line">   <span class="attr">foo</span>: <span class="number">1</span>,</span><br><span class="line">   <span class="attr">bar</span>: <span class="number">1</span></span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> state = <span class="title function_">toRaw</span>(obj)  <span class="comment">//普通的</span></span><br><span class="line"><span class="comment">// 响应式对象转化为普通对象</span></span><br></pre></td></tr></table></figure>





<h2 id="计算属性与监视"><a href="#计算属性与监视" class="headerlink" title="计算属性与监视"></a>计算属性与监视</h2><h3 id="computed函数"><a href="#computed函数" class="headerlink" title="computed函数"></a>computed函数</h3><ul>
<li><p>与Vue2.x中computed配置功能一致</p>
</li>
<li><p>写法</p>
<p>变成组合api了，想要用计算属性需要从vue里面引入计算属性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;computed&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> person=<span class="title function_">reactive</span>(&#123;</span><br><span class="line">        <span class="attr">firstName</span>:<span class="string">&#x27;123&#x27;</span>,</span><br><span class="line">        <span class="attr">lastName</span>:<span class="string">&#x27;456&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">	<span class="comment">//计算属性——简写</span></span><br><span class="line">    person.<span class="property">fullName</span> = <span class="title function_">computed</span>(<span class="function">()=&gt;</span>&#123;  <span class="comment">//可以直接把这个计算属性添加到person上面</span></span><br><span class="line">        <span class="comment">//反正也用不了this了，不如直接写箭头函数了</span></span><br><span class="line">        <span class="keyword">return</span> person.<span class="property">firstName</span> + <span class="string">&#x27;-&#x27;</span> + person.<span class="property">lastName</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//计算属性——完整</span></span><br><span class="line">    person.<span class="property">fullName</span> = <span class="title function_">computed</span>(&#123;</span><br><span class="line">        <span class="title function_">get</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> person.<span class="property">firstName</span> + <span class="string">&#x27;-&#x27;</span> + person.<span class="property">lastName</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">set</span>(<span class="params">value</span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> nameArr = value.<span class="title function_">split</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            person.<span class="property">firstName</span> = nameArr[<span class="number">0</span>]</span><br><span class="line">            person.<span class="property">lastName</span> = nameArr[<span class="number">1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">        person</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>或者使用get,set</p>
<p>get是读取计算属性的时候使用的，set是计算属性发生改变的时候使用的</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> name=<span class="title function_">computed</span>(&#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> fistName.<span class="property">value</span>+lastName.<span class="property">value</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">set</span>(<span class="params"></span>)&#123;</span><br><span class="line">        firstName.<span class="property">value</span>+lastName.<span class="property">value</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>一个购物车的例子</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">   &lt;div&gt;</span><br><span class="line">      &lt;table style=&quot;width:800px&quot; border&gt;</span><br><span class="line">         &lt;thead&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">               &lt;th&gt;名称&lt;/th&gt;</span><br><span class="line">               &lt;th&gt;数量&lt;/th&gt;</span><br><span class="line">               &lt;th&gt;价格&lt;/th&gt;</span><br><span class="line">               &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">         &lt;/thead&gt;</span><br><span class="line">         &lt;tbody&gt;</span><br><span class="line">            &lt;tr :key=&quot;index&quot; v-for=&quot;(item, index) in data&quot;&gt;</span><br><span class="line">               &lt;td align=&quot;center&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/td&gt;</span><br><span class="line">               &lt;td align=&quot;center&quot;&gt;</span><br><span class="line">                  &lt;button @click=&quot;AddAnbSub(item, false)&quot;&gt;-&lt;/button&gt;</span><br><span class="line">                  &#123;&#123; item.num &#125;&#125;</span><br><span class="line">                  &lt;button @click=&quot;AddAnbSub(item, true)&quot;&gt;+&lt;/button&gt;</span><br><span class="line">               &lt;/td&gt;</span><br><span class="line">               &lt;td align=&quot;center&quot;&gt;&#123;&#123; item.num * item.price &#125;&#125;&lt;/td&gt;</span><br><span class="line">               &lt;td align=&quot;center&quot;&gt;</span><br><span class="line">                  &lt;button @click=&quot;del(index)&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">               &lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">         &lt;/tbody&gt;</span><br><span class="line">         &lt;tfoot&gt;</span><br><span class="line">            &lt;tr&gt;</span><br><span class="line">               &lt;td&gt;&lt;/td&gt;</span><br><span class="line">               &lt;td&gt;&lt;/td&gt;</span><br><span class="line">               &lt;td&gt;&lt;/td&gt;</span><br><span class="line">               &lt;td align=&quot;center&quot;&gt;总价:&#123;&#123; $total &#125;&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">         &lt;/tfoot&gt;</span><br><span class="line">      &lt;/table&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123; computed, reactive, ref &#125; from &#x27;vue&#x27;</span><br><span class="line">type Shop = &#123;</span><br><span class="line">   name: string,</span><br><span class="line">   num: number,</span><br><span class="line">   price: number</span><br><span class="line">&#125;</span><br><span class="line">let $total = ref&lt;number&gt;(0)</span><br><span class="line">const data = reactive&lt;Shop[]&gt;([</span><br><span class="line">   &#123;</span><br><span class="line">      name: &quot;小满的袜子&quot;,</span><br><span class="line">      num: 1,</span><br><span class="line">      price: 100</span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">      name: &quot;小满的裤子&quot;,</span><br><span class="line">      num: 1,</span><br><span class="line">      price: 200</span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">      name: &quot;小满的衣服&quot;,</span><br><span class="line">      num: 1,</span><br><span class="line">      price: 300</span><br><span class="line">   &#125;,</span><br><span class="line">   &#123;</span><br><span class="line">      name: &quot;小满的毛巾&quot;,</span><br><span class="line">      num: 1,</span><br><span class="line">      price: 400</span><br><span class="line">   &#125;</span><br><span class="line">])</span><br><span class="line"> </span><br><span class="line">const AddAnbSub = (item: Shop, type: boolean = false): void =&gt; &#123;</span><br><span class="line">   if (item.num &gt; 1 &amp;&amp; !type) &#123;</span><br><span class="line">      item.num--</span><br><span class="line">   &#125;</span><br><span class="line">   if (item.num &lt;= 99 &amp;&amp; type) &#123;</span><br><span class="line">      item.num++</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">const del = (index: number) =&gt; &#123;  //这里这个删除商品的操作</span><br><span class="line">   data.splice(index, 1)</span><br><span class="line">&#125;</span><br><span class="line">$total = computed&lt;number&gt;(() =&gt; &#123;</span><br><span class="line">   return data.reduce((prev, next) =&gt; &#123;   </span><br><span class="line">      return prev + (next.num * next.price)  //reduce函数，prev前面的计算的值，next指每一个变量和它对应的price</span><br><span class="line">   &#125;, 0)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h3 id="watch函数"><a href="#watch函数" class="headerlink" title="watch函数"></a>watch函数</h3><p> 与Vue2.x中watch配置功能一致</p>
 <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">watch</span>([sum,msg],<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sum或msg变化了&#x27;</span>,newValue,oldValue)  <span class="comment">//这个时候newValue和oldValue都变成数组了</span></span><br><span class="line">&#125;，&#123;</span><br><span class="line">    <span class="attr">deep</span>:<span class="literal">true</span>  <span class="comment">//reactive对象默认就是deep,开不开都一样</span></span><br><span class="line">    <span class="attr">immediate</span>:<span class="literal">true</span> <span class="comment">//这个是一开始就执行一遍，一开始没有新值，所以新值会变成undefined</span></span><br><span class="line">&#125;) </span><br></pre></td></tr></table></figure>

<p> watch可以同时侦听多个属性，比如上面的例子里面的<code>[sum,msg]</code></p>
<p><img src="https://tu.sunning.fit/i/2022/07/15/62d0dfa47d3cc.png" alt="image-20220530175213693"></p>
<p> watch可以传递三个参数，一个是监视的物品，一个是监视的函数，一个是监视的配置</p>
<p> 深度监视当没有子物体的时候，也会给一个空数组</p>
<blockquote>
<p>如果对象用ref创建，ref.value会自动用reactive方式创建一个proxy对象，这时候</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">watch</span>(xxx,,)</span><br></pre></td></tr></table></figure>

<p>这时候监视xxx因为地址没有变，改xxx的值不会被监视到，而xxx.value就是监视proxy了，这时候的改变就能监视到</p>
<p>或者配置项开深度监视（ref创建的是不自动开深度监视的）</p>
</blockquote>
<p> 两个“坑”：</p>
<ul>
<li>监视reactive定义的响应式数据时：oldValue无法正确获取、强制开启了深度监视（deep配置失效）。</li>
<li>监视reactive定义的响应式数据中某个属性时：deep配置有效。</li>
</ul>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//情况一：监视ref定义的响应式数据，这个用的不是sum.value（因为这样子就访问value的那个具体的值了，ref定义的直接监视那个东西就行）</span></span><br><span class="line"><span class="title function_">watch</span>(sum,<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;    <span class="comment">//这个不用写xxx=watch 因为这个是一种行为，不是数据</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sum变化了&#x27;</span>,newValue,oldValue)</span><br><span class="line">&#125;,&#123;<span class="attr">immediate</span>:<span class="literal">true</span>&#125;) </span><br><span class="line"></span><br><span class="line"><span class="comment">//情况二：监视多个ref定义的响应式数据</span></span><br><span class="line"><span class="title function_">watch</span>([sum,msg],<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sum或msg变化了&#x27;</span>,newValue,oldValue)  <span class="comment">//这个时候newValue和oldValue都变成数组了</span></span><br><span class="line">&#125;) </span><br><span class="line"></span><br><span class="line"><span class="comment">/* 情况三：监视reactive定义的响应式数据</span></span><br><span class="line"><span class="comment">			若watch监视的是reactive定义的响应式数据，则无法正确获得oldValue！！</span></span><br><span class="line"><span class="comment">			若watch监视的是reactive定义的响应式数据，则强制开启了深度监视 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_">watch</span>(person,<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;person变化了&#x27;</span>,newValue,oldValue)</span><br><span class="line">&#125;,&#123;<span class="attr">immediate</span>:<span class="literal">true</span>,<span class="attr">deep</span>:<span class="literal">false</span>&#125;) <span class="comment">//此处的deep配置不再奏效</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//情况四：监视reactive定义的响应式数据中的 某个属性，要把这个东西写成一个函数</span></span><br><span class="line"><span class="title function_">watch</span>(<span class="function">()=&gt;</span>person.<span class="property">job</span>,<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class="line">&#125;,&#123;<span class="attr">immediate</span>:<span class="literal">true</span>,<span class="attr">deep</span>:<span class="literal">true</span>&#125;) </span><br><span class="line"></span><br><span class="line"><span class="comment">//情况五：监视reactive定义的响应式数据中的某些属性（就是情况二和情况四的结合）</span></span><br><span class="line"><span class="title function_">watch</span>([<span class="function">()=&gt;</span>person.<span class="property">job</span>,<span class="function">()=&gt;</span>person.<span class="property">name</span>],<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class="line">&#125;,&#123;<span class="attr">immediate</span>:<span class="literal">true</span>,<span class="attr">deep</span>:<span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//特殊情况</span></span><br><span class="line"><span class="title function_">watch</span>(<span class="function">()=&gt;</span>person.<span class="property">job</span>,<span class="function">(<span class="params">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class="line">&#125;,&#123;<span class="attr">deep</span>:<span class="literal">true</span>&#125;) <span class="comment">//此处由于监视的是reactive素定义的对象中的某个属性，所以deep配置有效</span></span><br></pre></td></tr></table></figure>

<h3 id="watchEffect函数"><a href="#watchEffect函数" class="headerlink" title="watchEffect函数"></a>watchEffect函数</h3><p> watch的套路是：既要指明监视的属性，也要指明监视的回调。</p>
<p> watchEffect的套路是：不用指明监视哪个属性，监视的<strong>回调中用到哪个属性，那就监视哪个属性</strong>。</p>
<p> watchEffect有点像computed：</p>
<ul>
<li>但computed注重的计算出来的值（回调函数的返回值），所以必须要写返回值。</li>
<li>而watchEffect更注重的是过程（回调函数的函数体），所以不用写返回值。</li>
</ul>
  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//watchEffect所指定的回调中用到的数据只要发生变化，则直接重新执行回调。</span></span><br><span class="line"><span class="title function_">watchEffect</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> x1 = sum.<span class="property">value</span></span><br><span class="line">    <span class="keyword">const</span> x2 = person.<span class="property">age</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;watchEffect配置的回调执行了&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="清除副作用"><a href="#清除副作用" class="headerlink" title="清除副作用"></a>清除副作用</h4><p>在触发监听之前会调用一个函数可以处理你的逻辑例如防抖</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; watchEffect, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">let</span> message = ref&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> message2 = ref&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="title function_">watchEffect</span>(<span class="function">(<span class="params">oninvalidate</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;message&#x27;</span>, message.<span class="property">value</span>);</span><br><span class="line">    <span class="title function_">oninvalidate</span>(<span class="function">()=&gt;</span>&#123;  <span class="comment">//就算上面有其他的语句，也是先执行这个回调，然后再处理其他的</span></span><br><span class="line">        </span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>停止跟踪，watchEffect返回一个函数，调用后将停止更新</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> stop =  <span class="title function_">watchEffect</span>(<span class="function">(<span class="params">oninvalidate</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//console.log(&#x27;message&#x27;, message.value);</span></span><br><span class="line">    <span class="title function_">oninvalidate</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line"> </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;message2&#x27;</span>, message2.<span class="property">value</span>);</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    <span class="attr">flush</span>:<span class="string">&quot;post&quot;</span>,</span><br><span class="line">    onTrigger () &#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="title function_">stop</span>()</span><br></pre></td></tr></table></figure>

<h4 id="更多配置项"><a href="#更多配置项" class="headerlink" title="更多配置项"></a>更多配置项</h4><h4 id="watchEffect调式"><a href="#watchEffect调式" class="headerlink" title="watchEffect调式"></a>watchEffect调式</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; watchEffect, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">let</span> message = ref&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> message2 = ref&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"> <span class="title function_">watchEffect</span>(<span class="function">(<span class="params">oninvalidate</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//console.log(&#x27;message&#x27;, message.value);</span></span><br><span class="line">    <span class="title function_">oninvalidate</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line"> </span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;message2&#x27;</span>, message2.<span class="property">value</span>);</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    <span class="attr">flush</span>:<span class="string">&quot;post&quot;</span>,</span><br><span class="line">    onTrigger (e) &#123;   <span class="comment">//有onTrigger的，被监视的属性发生变化会有断点</span></span><br><span class="line">        <span class="keyword">debugger</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>







<h1 id="虚拟DOM和diff算法"><a href="#虚拟DOM和diff算法" class="headerlink" title="虚拟DOM和diff算法"></a>虚拟DOM和diff算法</h1><h2 id="虚拟DOM"><a href="#虚拟DOM" class="headerlink" title="虚拟DOM"></a>虚拟DOM</h2><p>通过js来生成一个ADT节点树</p>
<p>dom上面有很多的属性，直接操作dom浪费性能，所以尽可能少操作dom,用js的计算性能换取操作dom消耗的性能</p>
<h2 id="Diff算法"><a href="#Diff算法" class="headerlink" title="Diff算法"></a>Diff算法</h2><p><img src="https://tu.sunning.fit/i/2022/07/14/62d012cb241ee.png" alt="image-20220714205105964"></p>
<p>没有key的就从前往后比对，如果一样的就复用，遇到第一个不一样的就覆盖，后面就正常生成。</p>
<p>有key的，先从前往后读，遇到第一个不一样的停下来，接着从后往前读，遇到第一个不一样的停下来，然后接着对剩下的东西比较，尽可能的复用</p>
<h1 id="Vue3-0中的响应式原理"><a href="#Vue3-0中的响应式原理" class="headerlink" title="Vue3.0中的响应式原理"></a>Vue3.0中的响应式原理</h1><h2 id="vue2-x的响应式"><a href="#vue2-x的响应式" class="headerlink" title="vue2.x的响应式"></a>vue2.x的响应式</h2><ul>
<li><p>实现原理：</p>
<ul>
<li><p>对象类型：通过<code>Object.defineProperty()</code>对属性的读取、修改进行拦截（数据劫持）。</p>
</li>
<li><p>数组类型：通过重写更新数组的一系列方法来实现拦截。（对数组的变更方法进行了包裹）。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(data, <span class="string">&#x27;count&#x27;</span>, &#123;</span><br><span class="line">    get () &#123;&#125;, </span><br><span class="line">    set () &#123;&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>存在问题：</p>
<ul>
<li>新增属性、删除属性, 界面不会更新。</li>
<li>直接通过下标修改数组, 界面不会自动更新。</li>
</ul>
</li>
<li><p>解决</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">set</span>(<span class="string">&#x27;名称&#x27;</span>,<span class="string">&#x27;增加的值&#x27;</span>，xxx)</span><br><span class="line"><span class="variable language_">this</span>.$set(<span class="string">&#x27;名称&#x27;</span>,<span class="string">&#x27;增加的值&#x27;</span>，xxx)</span><br><span class="line">如果是数组</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">set</span>(xxx.<span class="property">xxx</span>（数组），下标,更改的值)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Vue3-0的响应式"><a href="#Vue3-0的响应式" class="headerlink" title="Vue3.0的响应式"></a>Vue3.0的响应式</h2><p>给对象新增加一个东西，删除一个东西都可以检测到，用数组的下标来修改物体也可以</p>
<p>删除是 <code>delete person.name</code>   用delete来删除一个对象中的属性，如果用js没有vue删除是删不掉的，需要</p>
<p><code>configurable:true</code>配置项才能删除 </p>
<p><img src="https://tu.sunning.fit/i/2022/07/06/62c5469e61c2a.png" alt="image-20220530151738812"></p>
<ul>
<li>实现原理: <ul>
<li><p>通过Proxy（代理）:  拦截对象中任意属性的变化, 包括：属性值的读写、属性的添加、属性的删除等。</p>
</li>
<li><p>通过Reflect（反射）:  对源对象的属性进行操作。</p>
</li>
<li><p>&#96;&#96;&#96;js<br>const p&#x3D;new Proxy(person,{})</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  这时候对p的更改，可以体现在person上面</span><br><span class="line"></span><br><span class="line">- MDN文档中描述的Proxy与Reflect：</span><br><span class="line">  - Proxy：https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy</span><br><span class="line">  </span><br><span class="line">  - Reflect：https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflec t</span><br><span class="line">  </span><br><span class="line">    现在很多object上面有用的方法都移植到了reflect上面</span><br><span class="line">    </span><br><span class="line">    ![image-20220530162452177](vue3%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B.assets/image-20220530162452177.png)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    ```js</span><br><span class="line">    p=new Proxy(data, &#123;</span><br><span class="line">    	// 拦截读取属性值</span><br><span class="line">        get (target, prop) &#123;  //prop是更改的data的属性值，target在这里就是p</span><br><span class="line">        	return Reflect.get(target, prop)</span><br><span class="line">        &#125;,</span><br><span class="line">        // 拦截设置属性值或添加新属性</span><br><span class="line">        set (target, prop, value) &#123;  //value是想要更改的数值</span><br><span class="line">        	return Reflect.set(target, prop, value)  //会给一个布尔返回值，用来代表操作成功还是失败了</span><br><span class="line">        //这句和上面一句作用是一样的   target[prop]=value  //为什么不用.，因为用.会把后面的识别成字符串，相当于target.prop,而用[]会识别成变量，相当于target.prop代表的值</span><br><span class="line">        &#125;,</span><br><span class="line">        // 拦截删除属性</span><br><span class="line">        deleteProperty (target, prop) &#123;   </span><br><span class="line">        	return Reflect.deleteProperty(target, prop)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    proxy.name = &#x27;tom&#x27;   </span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="reactive对比ref"><a href="#reactive对比ref" class="headerlink" title="reactive对比ref"></a>reactive对比ref</h2><ul>
<li>从定义数据角度对比：<ul>
<li>ref用来定义：<strong style="color:#DD5145">基本类型数据</strong>。 </li>
<li>reactive用来定义：<strong style="color:#DD5145">对象（或数组）类型数据</strong>。</li>
<li>备注：ref也可以用来定义<strong style="color:#DD5145">对象（或数组）类型数据</strong>, 它内部会自动通过<code>reactive</code>转为<strong style="color:#DD5145">代理对象</strong>。</li>
</ul>
</li>
<li>从原理角度对比：<ul>
<li>ref通过<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>来实现响应式（数据劫持）。</li>
<li>reactive通过使用<strong style="color:#DD5145">Proxy</strong>来实现响应式（数据劫持）, 并通过<strong style="color:#DD5145">Reflect</strong>操作<strong style="color:orange">源对象</strong>内部的数据。</li>
</ul>
</li>
<li>从使用角度对比：<ul>
<li>ref定义的数据：操作数据<strong style="color:#DD5145">需要</strong><code>.value</code>，读取数据时模板中直接读取<strong style="color:#DD5145">不需要</strong><code>.value</code>。</li>
<li>reactive定义的数据：操作数据与读取数据：<strong style="color:#DD5145">均不需要</strong><code>.value</code>。</li>
</ul>
</li>
</ul>
<h2 id="setup的两个注意点"><a href="#setup的两个注意点" class="headerlink" title="setup的两个注意点"></a>setup的两个注意点</h2><p>在vue2中的组件传递数据，在用子组件的时候加上配置项</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;子组件名字  xxx=<span class="string">&#x27;xxx&#x27;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p>在子组件的声明的地方</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">props</span>:[<span class="string">&#x27;xxx&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>声明之后，这个xxx就会挂载在xxx上面，如果不写xxx,在$attrs.xxx也有（这里是无法确定类型的）</p>
<p>插槽也是，类似的实现，位置在 $slots 里面（vue2中）</p>
<ul>
<li><p>setup执行的时机</p>
<ul>
<li>在beforeCreate之前执行一次，this是undefined</li>
</ul>
</li>
<li><p>setup的参数</p>
<ul>
<li>props：值为对象，包含：组件外部传递过来，且组件内部声明接收了的属性。</li>
<li>context：上下文对象<ul>
<li>attrs: 值为对象，包含：组件外部传递过来，但没有在props配置中声明的属性, 相当于 <code>this.$attrs</code>。</li>
<li>slots: 收到的插槽内容, 相当于 <code>this.$slots</code>。</li>
<li>emit: 分发自定义事件的函数, 相当于 <code>this.$emit</code>。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://tu.sunning.fit/i/2022/07/06/62c546a80ddac.png" alt="image-20220530171050467"></p>
<h1 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h1><p>生命周期看红色的那些，绿色的是流程</p>
<div style="border:1px solid black;width:380px;float:left;margin-right:20px;"><strong>vue2.x的生命周期</strong><img src="https://cn.vuejs.org/images/lifecycle.png" alt="lifecycle_2" style="zoom:33%;width:1200px" /></div><div style="border:1px solid black;width:510px;height:985px;float:left"><strong>vue3.0的生命周期</strong><img src="https://v3.cn.vuejs.org/images/lifecycle.svg" alt="lifecycle_2" style="zoom:33%;width:2500px" /></div>















































<ul>
<li>Vue3.0中可以继续使用Vue2.x中的生命周期钩子，但有有两个被更名：<ul>
<li><code>beforeDestroy</code>改名为 <code>beforeUnmount</code></li>
<li><code>destroyed</code>改名为 <code>unmounted</code></li>
</ul>
</li>
<li>Vue3.0也提供了 Composition API 形式的生命周期钩子，与Vue2.x中钩子对应关系如下：（不是必须，也可以像vue2一样写在配置项里面）</li>
<li>拉开序幕的setup就等同于beforeCreate,created<ul>
<li><code>beforeCreate</code>&#x3D;&#x3D;&#x3D;&gt;<code>setup()</code></li>
<li><code>created</code>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>setup()</code></li>
<li><code>beforeMount</code> &#x3D;&#x3D;&#x3D;&gt;<code>onBeforeMount</code></li>
<li><code>mounted</code>&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onMounted</code></li>
<li><code>beforeUpdate</code>&#x3D;&#x3D;&#x3D;&gt;<code>onBeforeUpdate</code></li>
<li><code>updated</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onUpdated</code></li>
<li><code>beforeUnmount</code> &#x3D;&#x3D;&gt;<code>onBeforeUnmount</code></li>
<li><code>unmounted</code> &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;<code>onUnmounted</code></li>
</ul>
</li>
</ul>
<p>方便写箭头函数用df书写</p>
<p>组合式api的生命周期会比在配置项里面的生命周期快</p>
<h1 id="组件传值"><a href="#组件传值" class="headerlink" title="组件传值"></a>组件传值</h1><h2 id="父子组件传值"><a href="#父子组件传值" class="headerlink" title="父子组件传值"></a>父子组件传值</h2><h3 id="父传子"><a href="#父传子" class="headerlink" title="父传子"></a>父传子</h3><p>父组件<code>v-bind</code>绑定一个数据，子组件通过defineProps接受传过来的值</p>
<h4 id="父"><a href="#父" class="headerlink" title="父"></a>父</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&lt;<span class="title class_">Menu</span> v-<span class="attr">bind</span>:data=<span class="string">&quot;data&quot;</span>  title=<span class="string">&quot;我是标题&quot;</span>&gt;&lt;/<span class="title class_">Menu</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="子"><a href="#子" class="headerlink" title="子"></a>子</h4><p>通过defineProps 来接受 <strong>defineProps是无须引入的直接使用即可</strong></p>
<p>defineProps接受值，defineEmits接受方法</p>
<p>如果我们使用的TypeScript</p>
<p>可以使用传递字面量类型的纯类型语法做为参数</p>
<p>ts</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;menu&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        菜单区域 &#123;&#123; title &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; data &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"> </span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">defineProps&lt;&#123;</span></span><br><span class="line"><span class="language-xml">    title:string,</span></span><br><span class="line"><span class="language-xml">    data:number[]</span></span><br><span class="line"><span class="language-xml">&#125;&gt;()</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>js</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">defineProps</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>:&#123;</span><br><span class="line">        <span class="attr">default</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">type</span>:<span class="built_in">string</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">data</span>:<span class="title class_">Array</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="设一个默认的对象值"><a href="#设一个默认的对象值" class="headerlink" title="设一个默认的对象值"></a>设一个默认的对象值</h4><p>withDefaults是个函数也是无须引入开箱即用接受一个props函数第二个参数是一个对象设置默认值</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span> = &#123;</span><br><span class="line">    title?: <span class="built_in">string</span>,</span><br><span class="line">    data?: <span class="built_in">number</span>[]</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">withDefaults</span>(defineProps&lt;<span class="title class_">Props</span>&gt;(), &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;张三&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: <span class="function">() =&gt;</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">&#125;)   <span class="comment">//这里就是设置了一个默认的对象值</span></span><br></pre></td></tr></table></figure>

<h3 id="子传父"><a href="#子传父" class="headerlink" title="子传父"></a>子传父</h3><p>Vue中子组件不能直接向父组件传值，子组件需要调用父组件传递过来的方法，然后在父组件中通过方法修改值</p>
<p>先在父组件中通过自定义属性向子组件传递方法<code>@func=&quot;sayHello&quot;</code>然后子组件通过</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">emit</span>(<span class="string">&#x27;父组件传递过来的方法&#x27;</span>,<span class="string">&#x27;向这个方法传入的值&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>调用父组件的方法，变相地向父组件传值</p>
<h4 id="父-1"><a href="#父-1" class="headerlink" title="父"></a>父</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 通过子组件自定义属性传递值、方法 --&gt;</span><br><span class="line">    &lt;Subassembly :value=&quot;doc&quot; @func=&quot;sayHello&quot; /&gt;</span><br><span class="line">    &lt;button @click=&quot;sayHello(doc)&quot;&gt;父组件按钮&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">import Subassembly from &#x27;./Subassembly.vue&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 待传递的值</span><br><span class="line">const doc = ref(&#x27;hello&#x27;);</span><br><span class="line"></span><br><span class="line">// 待传递的方法</span><br><span class="line">const sayHello = function (data) &#123;</span><br><span class="line">  alert(data);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h4 id="子-1"><a href="#子-1" class="headerlink" title="子"></a>子</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;!-- 使用父组件传递过来的值 --&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123; props.value &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;button @click=&quot;handelClick&quot;&gt;子组件按钮&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">// 从 vue 中引入defineProps, defineEmits</span><br><span class="line">import &#123; defineProps, defineEmits &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 接收父组件传递过来的值</span><br><span class="line">const props = defineProps([&#x27;value&#x27;])</span><br><span class="line">// 接收父组件传递过来的方法</span><br><span class="line">const emit = defineEmits([&#x27;func&#x27;])</span><br><span class="line"></span><br><span class="line">const handelClick = function  () &#123;</span><br><span class="line">    //调用父组件传递过来的方法，传入参数修改父组件的值 </span><br><span class="line">    emit(&#x27;func&#x27;, &#x27;hello world&#x27;)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt; </span><br></pre></td></tr></table></figure>



<h2 id="依赖注入-Provide-x2F-Inject-vue组件的任何地方都可以传值和读取值"><a href="#依赖注入-Provide-x2F-Inject-vue组件的任何地方都可以传值和读取值" class="headerlink" title="依赖注入(Provide &#x2F; Inject) [vue组件的任何地方都可以传值和读取值]"></a>依赖注入(Provide &#x2F; Inject) [vue组件的任何地方都可以传值和读取值]</h2><p><img src="https://tu.sunning.fit/i/2022/07/17/62d3de30a999c.png" alt="image-20220717180222001"></p>
<p>传递数据</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">provide</span>(<span class="string">&#x27;flag&#x27;</span>,flag)</span><br></pre></td></tr></table></figure>

<p>子组件接受</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">inject&lt;<span class="title class_">Ref</span>&lt;<span class="built_in">number</span>&gt;&gt;(<span class="string">&#x27;flag&#x27;</span>,<span class="title function_">ref</span>(<span class="number">1</span>))</span><br></pre></td></tr></table></figure>


<blockquote>
<p>这里也可以 <code>inject&lt;Ref&lt;number&gt;&gt;(&#39;flag&#39;)</code>  但是因为没有默认值在ts里面会报错，所以要给一个默认值,</p>
<p>Ref表示这是一个Ref包裹的泛型，是number类型</p>
</blockquote>
<blockquote>
<p><strong>原理：</strong></p>
<p>provide默认情况下，实例继承父类的provides对象，如果当前组件有自己的provide,使用父provides对象作为原型来创建自己的provides对象，在inject只需要查询原型链就行</p>
</blockquote>
<h2 id="兄弟组件传参和Bus"><a href="#兄弟组件传参和Bus" class="headerlink" title="兄弟组件传参和Bus"></a>兄弟组件传参和Bus</h2><h3 id="还是父子"><a href="#还是父子" class="headerlink" title="还是父子"></a>还是父子</h3><p>A传递给兄弟B,可以先传递给父亲C,然后再由C传递给B实现传参</p>
<p>就相当于重新练习了父子组件传参</p>
<p>A自定义事件，派发出事件和值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;emitB&quot;&gt;派发一个事件&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">const emit = defineEmits([&#x27;on-click&#x27;])  //自定义一个事件</span><br><span class="line">let flag = false;</span><br><span class="line">const emitB = () =&gt; &#123;</span><br><span class="line">  flag = !flag;</span><br><span class="line">  emit(&quot;on-click&quot;, flag);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>C获得A的自定义事件，然后传递给B</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;A @on-click=&quot;getFlag&quot;&gt;&lt;/A&gt;</span><br><span class="line">  &lt;B :flag=&quot;flag&quot;&gt;&lt;/B&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line">import A from &quot;../../components/A.vue&quot;</span><br><span class="line">import B from &quot;../../components/B.vue&quot;</span><br><span class="line"></span><br><span class="line">let flag = ref(false);</span><br><span class="line">const getFlag = (params: boolean) =&gt; &#123;</span><br><span class="line">  flag.value = params;</span><br><span class="line">  console.log(params)</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>B读取A发送的变量</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&#123;&#123;flag&#125;&#125;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">type Props = &#123;</span><br><span class="line">  flag: boolean</span><br><span class="line">&#125;</span><br><span class="line">defineProps&lt;Props&gt;();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="手写BUS"><a href="#手写BUS" class="headerlink" title="手写BUS"></a>手写BUS</h3><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">BusClass</span>&lt;T&gt; = &#123;</span><br><span class="line">  <span class="attr">emit</span>: <span class="function">(<span class="params">name: T</span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">on</span>: <span class="function">(<span class="params">name: T, callback: <span class="built_in">Function</span></span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">BusParams</span> = <span class="built_in">string</span> | <span class="built_in">number</span> | <span class="built_in">symbol</span>;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">List</span> = &#123;</span><br><span class="line">  [<span class="attr">key</span>: <span class="title class_">BusParams</span>]: <span class="title class_">Array</span>&lt;<span class="title class_">Function</span>&gt;; <span class="comment">//on可以注册多个函数，他们的名字是允许一样的，所以用Array</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bus</span>&lt;T <span class="keyword">extends</span> <span class="title class_">BusParams</span>&gt; <span class="keyword">implements</span> <span class="title class_">BusClass</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="attr">list</span>: <span class="title class_">List</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//构造的时候要把这个数组置空</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">emit</span>(<span class="attr">name</span>: T, ...<span class="attr">args</span>: <span class="title class_">Array</span>&lt;<span class="built_in">any</span>&gt;): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">//获取所有的参数，具体的参数是什么就不在乎了</span></span><br><span class="line">    <span class="keyword">let</span> <span class="attr">eventName</span>: <span class="title class_">Array</span>&lt;<span class="title class_">Function</span>&gt; = <span class="variable language_">this</span>.<span class="property">list</span>[name];</span><br><span class="line">    eventName.<span class="title function_">forEach</span>(<span class="function">(<span class="params">fn</span>) =&gt;</span> &#123;</span><br><span class="line">      fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args); <span class="comment">//因为args解构完成正好是一个数组，所以可以直接传入args</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">on</span>(<span class="attr">name</span>: T, <span class="attr">callback</span>: <span class="title class_">Function</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">fn</span>: <span class="title class_">Array</span>&lt;<span class="title class_">Function</span>&gt; = <span class="variable language_">this</span>.<span class="property">list</span>[name] || [];</span><br><span class="line">    fn.<span class="title function_">push</span>(callback);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span>[name] = fn;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Bus</span>(); <span class="comment">//这是导出了个bus对象(由new Bus生成的)</span></span><br></pre></td></tr></table></figure>

<p>自己写完之后传值就和vue2的bus一样了</p>
<p>传</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">bus.<span class="title function_">emit</span>(<span class="string">&#x27;on-click&#x27;</span>, flag);</span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line">bus.<span class="title function_">on</span>(<span class="string">&#x27;on-click&#x27;</span>, <span class="function">(<span class="params">Flag: <span class="built_in">boolean</span></span>) =&gt;</span> &#123;  <span class="comment">//后面接一个回调函数，函数传入的变量是on-click传的东西</span></span><br><span class="line">  flag.<span class="property">value</span> = <span class="title class_">Flag</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Mitt"><a href="#Mitt" class="headerlink" title="Mitt"></a>Mitt</h3><p>vue3中<code>$on</code>，<code>$off</code> 和 <code>$once</code> 实例方法已被移除，组件实例不再实现事件触发接口，因此大家熟悉的EventBus便无法使用了。然而我们习惯了使用EventBus，对于这种情况我们可以使用Mitt库</p>
<h4 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm install mitt -S</span><br></pre></td></tr></table></figure>

<h4 id="2-main-ts-初始化"><a href="#2-main-ts-初始化" class="headerlink" title="2.main.ts 初始化"></a>2.main.ts 初始化</h4><p>全局总线，vue 入口文件 main.js 中挂载全局属性</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&#x27;mitt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Mit</span> = <span class="title function_">mitt</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//TypeScript注册</span></span><br><span class="line"><span class="comment">// 由于必须要拓展ComponentCustomProperties类型才能获得类型提示</span></span><br><span class="line">declare <span class="variable language_">module</span> <span class="string">&quot;vue&quot;</span> &#123;</span><br><span class="line">    <span class="keyword">export</span> interface <span class="title class_">ComponentCustomProperties</span> &#123;</span><br><span class="line">        <span class="attr">$Bus</span>: <span class="keyword">typeof</span> <span class="title class_">Mit</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//Vue3挂载全局API</span></span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$Bus</span> = <span class="title class_">Mit</span></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="3派发，添加，移除，清空"><a href="#3派发，添加，移除，清空" class="headerlink" title="3派发，添加，移除，清空"></a>3派发，添加，移除，清空</h4><p><strong>A组件派发（emit）</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是A<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;emit1&quot;</span>&gt;</span>emit1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;emit2&quot;</span>&gt;</span>emit2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&#x27;ts&#x27;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; getCurrentInstance &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> <span class="title function_">emit1</span> = (<span class="params"></span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    instance?.<span class="property">proxy</span>?.<span class="property">$Bus</span>.<span class="title function_">emit</span>(<span class="string">&#x27;on-num&#x27;</span>, <span class="number">100</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> <span class="title function_">emit2</span> = (<span class="params"></span>) =&gt; &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    instance?.<span class="property">proxy</span>?.<span class="property">$Bus</span>.<span class="title function_">emit</span>(<span class="string">&#x27;*****&#x27;</span>, <span class="number">500</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>B组件监听（on）</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是B<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&#x27;ts&#x27;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; getCurrentInstance &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> instance = <span class="title function_">getCurrentInstance</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">instance?.<span class="property">proxy</span>?.<span class="property">$Bus</span>.<span class="title function_">on</span>(<span class="string">&#x27;on-num&#x27;</span>, <span class="function">(<span class="params">num</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(num,<span class="string">&#x27;===========&gt;B&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>监听所有事件（ on(“*”) ）</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">instance?.<span class="property">proxy</span>?.<span class="property">$Bus</span>.<span class="title function_">on</span>(<span class="string">&#x27;*&#x27;</span>,<span class="function">(<span class="params">type,num</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(type,num,<span class="string">&#x27;===========&gt;B&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>移除监听事件（off）</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Fn</span> = (<span class="params">num: any</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(num, <span class="string">&#x27;===========&gt;B&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line">instance?.<span class="property">proxy</span>?.<span class="property">$Bus</span>.<span class="title function_">on</span>(<span class="string">&#x27;on-num&#x27;</span>,<span class="title class_">Fn</span>)<span class="comment">//listen</span></span><br><span class="line">instance?.<span class="property">proxy</span>?.<span class="property">$Bus</span>.<span class="title function_">off</span>(<span class="string">&#x27;on-num&#x27;</span>,<span class="title class_">Fn</span>)<span class="comment">//unListen</span></span><br></pre></td></tr></table></figure>

<p><strong>清空所有监听（clear）</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">instance?.<span class="property">proxy</span>?.<span class="property">$Bus</span>.<span class="property">all</span>.<span class="title function_">clear</span>()</span><br></pre></td></tr></table></figure>



<h1 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h1><h2 id="局部组件"><a href="#局部组件" class="headerlink" title="局部组件"></a>局部组件</h2><p>平时引入组件的方式就是局部引入</p>
<h2 id="全局组件"><a href="#全局组件" class="headerlink" title="全局组件"></a>全局组件</h2><p>不用引入，就可以在全局的任意位置使用</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/reset/index.less&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Card</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Card/index.vue&#x27;</span>  <span class="comment">//想引入的全局组件</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">component</span>(<span class="string">&#x27;Card&#x27;</span>,<span class="title class_">Card</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)  <span class="comment">//component(&#x27;Card&#x27;,Card) &#x27;Card&#x27;是在全局调用的组件的名称，Card是引入的实例</span></span><br></pre></td></tr></table></figure>



<h2 id="递归组件"><a href="#递归组件" class="headerlink" title="递归组件"></a>递归组件</h2><p>原理跟我们写js递归是一样的 自己调用自己 通过一个条件来结束递归 否则导致内存泄漏</p>
<p>例子：递归树</p>
<p>在父组件配置数据结构 数组对象格式 传给子组件</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">TreeList</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  icon?: <span class="built_in">string</span>;</span><br><span class="line">  children?: <span class="title class_">TreeList</span>[] | [];</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> data = reactive&lt;<span class="title class_">TreeList</span>[]&gt;([</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;no.1&quot;</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;no.1-1&quot;</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&quot;no.1-1-1&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;no.2&quot;</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;no.2-1&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;no.3&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<p>子组件接收值</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">TreeList</span> = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span>;</span><br><span class="line">  icon?: <span class="built_in">string</span>;</span><br><span class="line">  children?: <span class="title class_">TreeList</span>[] | [];</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Props</span>&lt;T&gt; = &#123;</span><br><span class="line">  data?: T[] | [];</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">defineProps&lt;<span class="title class_">Props</span>&lt;<span class="title class_">TreeList</span>&gt;&gt;();</span><br></pre></td></tr></table></figure>

<p>template</p>
<p>TreeItem 其实就是当前组件 通过import 把自身又引入了一遍 如果他没有children 了就结束</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-left:10px;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;tree&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;(item,index) in data&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> @<span class="attr">click</span>=<span class="string">&#x27;clickItem(item)&#x27;</span>&gt;</span>&#123;&#123;item.name&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">TreeItem</span> @<span class="attr">on-click</span>=<span class="string">&#x27;clickItem&#x27;</span> <span class="attr">v-if</span>=<span class="string">&#x27;item?.children?.length&#x27;</span> <span class="attr">:data</span>=<span class="string">&quot;item.children&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">TreeItem</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>?的使用</p>
<p>item.children? 判断这个组件是否存在，如果不存在返回undefined类同false</p>
<p>item?.children ?? ‘123’</p>
<p>??双问号就是判断左边的成不成立，如果左边不成立就使用右边</p>
<p>和||的区别是0和””（空字符串）还是会返回默认值，只有null和undefined被??判断做不成立</p>
</blockquote>
<h2 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h2><p>让多个组件使用同一个挂载点，并动态切换，这就是动态组件</p>
<p>和路由的区别在于这个的路由是不变的</p>
<p>通过这里的:is 后面指的不同的组件实例切换</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;component :is=&quot;A&quot;&gt;&lt;/component&gt;</span><br></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div @click=&quot;switchCom&quot; :key=&quot;item.name&quot; v-for=&quot;item in data&quot;&gt;</span><br><span class="line">    &#123;&#123;item.name&#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import A from &#x27;./Content/index.vue&#x27;</span><br><span class="line">import B from &#x27;./Header/index.vue&#x27;</span><br><span class="line">import C from &#x27;./Menu/index.vue&#x27;</span><br><span class="line">import &#123;reactive&#125; from &quot;vue&quot;;</span><br><span class="line"></span><br><span class="line">type Tabs = &#123;</span><br><span class="line">  name: string,</span><br><span class="line">  comName: any,</span><br><span class="line">&#125;</span><br><span class="line">type Com = Pick&lt;Tabs, &#x27;comName&#x27;&gt;</span><br><span class="line">const data = reactive&lt;Tabs[]&gt;([</span><br><span class="line">  &#123;</span><br><span class="line">    name: &#x27;a组件&#x27;,</span><br><span class="line">    comName: A</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    name: &#x27;b组件&#x27;,</span><br><span class="line">    comName: B</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    name: &#x27;c组件&#x27;,</span><br><span class="line">    comName: C</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line">let current = reactive&lt;Com&gt;(&#123;comName: data[0].comName&#125;)</span><br><span class="line">const switchCom = (item: Tabs) =&gt; &#123;</span><br><span class="line">  current.comName = item.comName;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<p>1.在vue2的时候js是通过组件名称切换的，在vue3 setup是通过组件实例切换的</p>
<p> 2.如果你把组件实例放到Reactive Vue会给你一个警告runtime-core.esm-bundler.js:38 [Vue warn]: Vue received a Component which was made a reactive object. This can lead to unnecessary performance overhead, and should be avoided by marking the component with <code>markRaw</code> or using <code>shallowRef</code> instead of <code>ref</code>.<br>Component that was made reactive: </p>
<p>这是因为reactive 会进行proxy 代理 而我们组件代理之后毫无用处 节省性能开销 推荐我们使用shallowRef 或者  markRaw 跳过proxy 代理</p>
<blockquote>
<p>Pick的用法</p>
</blockquote>
<h2 id="传送组件Teleport"><a href="#传送组件Teleport" class="headerlink" title="传送组件Teleport"></a>传送组件Teleport</h2><p><code>Teleport</code> 是一种能够将我们的模板渲染至指定<code>DOM</code>节点，不受父级<code>style</code>、<code>v-show</code>等属性影响，但<code>data</code>、<code>prop</code><strong style="color:#DD5145">数据依旧能够共用</strong>的技术</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div class=&quot;xxx&quot;&gt;  //这里写的样式对teleport组件就没啥作用了</span><br><span class="line">    &lt;teleport to=&quot;移动位置&quot;&gt;   //例如 to body //用控制台看结构是什么</span><br><span class="line">	&lt;div v-if=&quot;isShow&quot; class=&quot;mask&quot;&gt;</span><br><span class="line">		&lt;div class=&quot;dialog&quot;&gt;</span><br><span class="line">			&lt;h3&gt;我是一个弹窗&lt;/h3&gt;</span><br><span class="line">			&lt;button @click=&quot;isShow = false&quot;&gt;关闭弹窗&lt;/button&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/teleport&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>支持class id等选择器</p>
<h2 id="缓存组件-keep-alive"><a href="#缓存组件-keep-alive" class="headerlink" title="缓存组件(keep-alive)"></a>缓存组件(keep-alive)</h2><p>内置组件（keep-alive）</p>
<p>有时候我们不希望组件被重新渲染影响使用体验；或者处于性能考虑，避免多次重复渲 染降低性能。而是希望组件可以缓存下来,维持当前的状态。这时候就需要用到<code>keep-alive</code>组件。 </p>
<p>   如果跑到了另一个页面，原来填的东西还是会保存的，这就是缓存组件的作用</p>
<p>缓存组件里面只能填一个组件。</p>
<h3 id="生命周期的变化"><a href="#生命周期的变化" class="headerlink" title="生命周期的变化"></a>生命周期的变化</h3><p>第一次挂载完成后，之后keep-alive的切换就</p>
<p>onActivated和onDeactivated这两个方法了 </p>
<h3 id="include-和-exclude和max"><a href="#include-和-exclude和max" class="headerlink" title="include 和 exclude和max"></a><code>include</code> 和 <code>exclude</code>和<code>max</code></h3><p> include 和 exclude</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">:include</span>=<span class="string">&quot;&quot;</span> <span class="attr">:exclude</span>=<span class="string">&quot;&quot;</span> <span class="attr">:max</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>include 和 exclude prop 允许组件有条件地缓存。二者都可以用逗号分隔字符串、正则表达式或一个数组来表示：</p>
<p>include指定缓存哪一个，exclude指定不缓存哪一个</p>
<p>max指最多缓存多少个</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">:max</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="插槽"><a href="#插槽" class="headerlink" title="插槽"></a>插槽</h1><p>插槽就是子组件提供给父组件使用的一个占位符，用&lt; slot &gt;&lt; &#x2F;slot&gt; 表示，父组件可以在这个占位符中填充任何模板代码，如 HTML、组件等，填充的内容会替换子组件的&lt; slot&gt;&lt; &#x2F;slot&gt;标签。</p>
<h2 id="匿名插槽"><a href="#匿名插槽" class="headerlink" title="匿名插槽"></a>匿名插槽</h2><p>在子组件Dialog放置一个插槽</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">       &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure>

<p>父组件使用插槽,给这个插槽内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">   &lt;template v-slot&gt;</span><br><span class="line">       &lt;div&gt;2132&lt;/div&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">&lt;/Dialog&gt;</span><br></pre></td></tr></table></figure>

<h2 id="具名插槽"><a href="#具名插槽" class="headerlink" title="具名插槽"></a>具名插槽</h2><p>就是给插槽取个名字，一个子组件可以有多个插槽，而且可以放在不同的地方，而父组件填充内容时，可以根据名字把对应内容填充到对应插槽中</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;slot name=&quot;footer&quot;&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>父组件使用对应的名称</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">    &lt;template v-slot:header&gt;</span><br><span class="line">       &lt;div&gt;1&lt;/div&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">   &lt;template v-slot&gt;</span><br><span class="line">       &lt;div&gt;2&lt;/div&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">   &lt;template v-slot:footer&gt;</span><br><span class="line">       &lt;div&gt;3&lt;/div&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">&lt;/Dialog&gt;</span><br></pre></td></tr></table></figure>

<p>插槽的简写形式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">    &lt;template #header&gt;</span><br><span class="line">       &lt;div&gt;1&lt;/div&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">   &lt;template #default&gt;</span><br><span class="line">       &lt;div&gt;2&lt;/div&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">   &lt;template #footer&gt;</span><br><span class="line">       &lt;div&gt;3&lt;/div&gt;</span><br><span class="line">   &lt;/template&gt;</span><br><span class="line">&lt;/Dialog&gt;</span><br></pre></td></tr></table></figure>



<h2 id="作用域插槽"><a href="#作用域插槽" class="headerlink" title="作用域插槽"></a>作用域插槽</h2><p>子组件绑定参数，父组件读取然后使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;div v-for=&quot;item in 100&quot;&gt;</span><br><span class="line">            &lt;slot :data=&quot;item&quot;&gt;&lt;/slot&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"> </span><br><span class="line">    &lt;slot name=&quot;footer&quot;&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>通过解构方式取值,下面这个是读子组件传递过来的值，然后把data拿出来</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> &lt;Dialog&gt;</span><br><span class="line">    &lt;template #header&gt;</span><br><span class="line">        &lt;div&gt;1&lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;template #default=&quot;&#123; data &#125;&quot;&gt;</span><br><span class="line">        &lt;div&gt;&#123;&#123; data &#125;&#125;&lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;template #footer&gt;</span><br><span class="line">        &lt;div&gt;3&lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">&lt;/Dialog&gt;</span><br></pre></td></tr></table></figure>



<h2 id="动态插槽"><a href="#动态插槽" class="headerlink" title="动态插槽"></a>动态插槽</h2><p>插槽可以是一个变量名</p>
<p>定义</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Dialog&gt;</span><br><span class="line">    &lt;template #[name]&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            23</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">&lt;/Dialog&gt;</span><br></pre></td></tr></table></figure>
<p>使用</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="title function_">ref</span>(<span class="string">&#x27;header&#x27;</span>) <span class="comment">//想切换渲染的对象改name就行了</span></span><br></pre></td></tr></table></figure>

<h1 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h1><p><code>transition</code>组件</p>
<p><code>&lt;transition&gt;</code>元素作为单个元素&#x2F;组件的过渡效果，它只会把过渡效果应用到其包裹的内容上，而不会额外渲染 DOM 元素，也不会出现在检测过的组件层级中</p>
<h2 id="6个class类"><a href="#6个class类" class="headerlink" title="6个class类"></a>6个class类</h2><p><img src="https://tu.sunning.fit/i/2022/07/16/62d28a8ed5851.png" alt="image-20220716175316022"></p>
<p>v-enter-from：定义进入过渡的开始状态。在元素被插入之前生效，在元素被插入之后的下一帧移除。</p>
<p>v-enter-active：定义进入过渡生效时的状态。在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡&#x2F;动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数。</p>
<p>v-enter-to：定义进入过渡的结束状态。在元素被插入之后下一帧生效 (与此同时 v-enter-from 被移除)，在过渡&#x2F;动画完成之后移除。</p>
<p>v-leave-from：定义离开过渡的开始状态。在离开过渡被触发时立刻生效，下一帧被移除。</p>
<p>v-leave-active：定义离开过渡生效时的状态。在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡&#x2F;动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数。</p>
<p>v-leave-to：离开过渡的结束状态。在离开过渡被触发之后下一帧生效 (与此同时 v-leave-from 被移除)，在过渡&#x2F;动画完成之后移除。</p>
<p>v和自定义的类同名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;button @click=&#x27;flag = !flag&#x27;&gt;切换&lt;/button&gt;</span><br><span class="line">&lt;transition name=&#x27;fade&#x27;&gt;</span><br><span class="line">  &lt;div v-if=&#x27;flag&#x27; class=&quot;box&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/transition&gt;</span><br><span class="line"></span><br><span class="line">//开始过度</span><br><span class="line">.fade-enter-from&#123;</span><br><span class="line">   background:red;</span><br><span class="line">   width:0px;</span><br><span class="line">   height:0px;</span><br><span class="line">   transform:rotate(360deg)</span><br><span class="line">&#125;</span><br><span class="line">//开始过度了</span><br><span class="line">.fade-enter-active&#123;</span><br><span class="line">  transition: all 2.5s linear;</span><br><span class="line">&#125;</span><br><span class="line">//过度完成</span><br><span class="line">.fade-enter-to&#123;</span><br><span class="line">   background:yellow;</span><br><span class="line">   width:200px;</span><br><span class="line">   height:200px;</span><br><span class="line">&#125;</span><br><span class="line">//离开的过度</span><br><span class="line">.fade-leave-from&#123;</span><br><span class="line">  width:200px;</span><br><span class="line">  height:200px;</span><br><span class="line">  transform:rotate(360deg)</span><br><span class="line">&#125;</span><br><span class="line">//离开中过度</span><br><span class="line">.fade-leave-active&#123;</span><br><span class="line">  transition: all 1s linear;</span><br><span class="line">&#125;</span><br><span class="line">//离开完成</span><br><span class="line">.fade-leave-to&#123;</span><br><span class="line">  width:0px;</span><br><span class="line">   height:0px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="自定义过度class类名"><a href="#自定义过度class类名" class="headerlink" title="自定义过度class类名"></a>自定义过度class类名</h2><ul>
<li><code>enter-from-class</code></li>
<li><code>enter-active-class</code></li>
<li><code>enter-to-class</code></li>
<li><code>leave-from-class</code></li>
<li><code>leave-active-class</code></li>
<li><code>leave-to-class</code></li>
</ul>
<p>自定义class结合css动画库animate css可以很方便地使用动画</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;transition</span><br><span class="line">    leave-active-class=&quot;animate__animated animate__bounceInLeft&quot;</span><br><span class="line">    enter-active-class=&quot;animate__animated animate__bounceInRight&quot;</span><br><span class="line">&gt;</span><br><span class="line">    &lt;div v-if=&quot;flag&quot; class=&quot;box&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/transition&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>对于新版的animate css引用类的时候需要加一个前缀</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">leave-active-class</span>=<span class="string">&quot;animate__animated animate__bounce&quot;</span>&gt;</span>An animated element<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>也可以分别指定进入和离开的持续时间</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;transition :duration=&quot;1000&quot;&gt;...&lt;/transition&gt;</span><br><span class="line">&lt;transition :duration=&quot;&#123; enter: 500, leave: 800 &#125;&quot;&gt;...&lt;/transition&gt;</span><br></pre></td></tr></table></figure>



<h2 id="transition生命周期8个"><a href="#transition生命周期8个" class="headerlink" title="transition生命周期8个"></a>transition生命周期8个</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">@before-enter=<span class="string">&quot;beforeEnter&quot;</span> //对应enter-from</span><br><span class="line">@enter=<span class="string">&quot;enter&quot;</span>//对应enter-active</span><br><span class="line">@after-enter=<span class="string">&quot;afterEnter&quot;</span>//对应enter-to</span><br><span class="line">@enter-cancelled=<span class="string">&quot;enterCancelled&quot;</span>//显示过度打断</span><br><span class="line">@before-leave=<span class="string">&quot;beforeLeave&quot;</span>//对应leave-from</span><br><span class="line">@leave=<span class="string">&quot;leave&quot;</span>//对应enter-active</span><br><span class="line">@after-leave=<span class="string">&quot;afterLeave&quot;</span>//对应leave-to</span><br><span class="line">@leave-cancelled=<span class="string">&quot;leaveCancelled&quot;</span>//离开过度打断</span><br></pre></td></tr></table></figure>

<p>在用js过度的时候，enter和leave钩子中必须使用done进行回调</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">beforeEnter</span> = (<span class="params">el: Element</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;进入之前from&#x27;</span>, el);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Enter</span> = (<span class="params">el: Element,done:<span class="built_in">Function</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;过度曲线&#x27;</span>);  <span class="comment">//这里是动画执行完了，</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">       <span class="title function_">done</span>()  <span class="comment">//但是执行完了vue在没调用done之前都会当作动画还在执行</span></span><br><span class="line">    &#125;,<span class="number">3000</span>)  <span class="comment">//所以这里过了三秒钟才会显示动画执行完成</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">AfterEnter</span> = (<span class="params">el: Element</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;to&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配合js库，可以做出很多好看的效果： （例如GreenSock）</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">EnterFrom</span>=(<span class="params">el:Element</span>)=&gt;&#123;</span><br><span class="line">    gasp.<span class="title function_">set</span>(el,&#123;</span><br><span class="line">        <span class="attr">width</span>:<span class="number">0</span>,</span><br><span class="line">        <span class="attr">height</span>:<span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">EnterActive</span>=(<span class="params">el:Element,done:gasp.Callback</span>)=&gt;&#123;</span><br><span class="line">    gasp.<span class="title function_">to</span>(el,&#123;</span><br><span class="line">        <span class="attr">width</span>:<span class="number">200</span></span><br><span class="line">        <span class="attr">height</span>:<span class="number">200</span>,</span><br><span class="line">        <span class="attr">onComplete</span>:done   <span class="comment">//这里这个就是覆盖每个Enter必须要填的done,而且默认传入的参数是gasp.Callback类型的</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="Appear属性"><a href="#Appear属性" class="headerlink" title="Appear属性"></a>Appear属性</h2><p>一进入页面就执行的属性,这个也能结合Animate.css </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">appear-active-<span class="keyword">class</span>=<span class="string">&quot;&quot;</span></span><br><span class="line">appear-<span class="keyword">from</span>-<span class="keyword">class</span>=<span class="string">&quot;&quot;</span></span><br><span class="line">appear-to-<span class="keyword">class</span>=<span class="string">&quot;&quot;</span></span><br><span class="line">appear</span><br></pre></td></tr></table></figure>

<p>这些属性直接在transition标签上面用的</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">appear</span> </span></span><br><span class="line"><span class="tag"><span class="attr">appear-active-class</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">appear-from-class</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">appear-to-class</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Transition-group过度列表"><a href="#Transition-group过度列表" class="headerlink" title="Transition-group过度列表"></a>Transition-group过度列表</h2><ul>
<li><p>默认情况下，它不会渲染一个包裹元素，但是你可以通过 <code>tag attribute</code> 指定渲染一个元素。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">tag</span>=<span class="string">&quot;section&quot;</span>&gt;</span> xxxxx<span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样会在xxxx外面包一层整体的section</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/transitions-enterleave.html#%E8%BF%87%E6%B8%A1%E6%A8%A1%E5%BC%8F">过渡模式</a>不可用，因为我们不再相互切换特有的元素。</p>
</li>
<li><p>内部元素<strong>总是需要</strong>提供唯一的 <code>key attribute</code> 值。</p>
</li>
<li><p>CSS 过渡的类将会应用在内部的元素中，而不是这个组&#x2F;容器本身。</p>
</li>
</ul>
<h3 id="进入离开过度"><a href="#进入离开过度" class="headerlink" title="进入离开过度"></a>进入离开过度</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;transition-group leave-active-class=&quot;animate_animated animate_hinge&quot; enter-active-clas=&quot;animate_animated animate_bounceIn&quot;&gt;</span><br><span class="line">     &lt;div style=&quot;margin: 10px;&quot; :key=&quot;item&quot; v-for=&quot;item in list&quot;&gt;&#123;&#123; item &#125;&lt;/div&gt;</span><br><span class="line">&lt;/transition-group&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> list = reactive&lt;<span class="built_in">number</span>[]&gt;([<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>])</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Push</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    list.<span class="title function_">push</span>(<span class="number">123</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Pop</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    list.<span class="title function_">pop</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种应用会有很多有意思的效果</p>
<p><img src="https://tu.sunning.fit/i/2022/07/16/62d2a17e7a1cc.png" alt="image-20220716193107352"></p>
<h3 id="移动过渡"><a href="#移动过渡" class="headerlink" title="移动过渡"></a>移动过渡</h3><h4 id="例：平移的数字"><a href="#例：平移的数字" class="headerlink" title="例：平移的数字"></a>例：平移的数字</h4><p><img src="https://tu.sunning.fit/i/2022/07/17/62d373af7f223.png" alt="image-20220717102757094"></p>
<p>在transition-group里面加上个move-class&#x3D;”xxx”的标签，然后在css里面写对应的动画即可</p>
<p><strong>完整代码：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;button @click=&quot;random&quot;&gt;random&lt;/button&gt;</span><br><span class="line">  &lt;transition-group move-class=&quot;mmm&quot; class=&quot;wraps&quot; tag=&quot;div&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;items&quot; :key=&quot;item.id&quot; v-for=&quot;item in list&quot;&gt;&#123;&#123; item.number &#125;&#125;&lt;/div&gt;</span><br><span class="line">  &lt;/transition-group&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123;ref&#125; from &quot;vue&quot;;</span><br><span class="line">import _ from &#x27;lodash&#x27;</span><br><span class="line"></span><br><span class="line">let list = ref(Array.apply(null, &#123;length: 81&#125; as number[]).map((_, index) =&gt; &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    id: index,</span><br><span class="line">    number: (index % 9) + 1</span><br><span class="line">  &#125;</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">const random = () =&gt; &#123;</span><br><span class="line">  list.value = _.shuffle(list.value);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line">.wraps &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-wrap: wrap;</span><br><span class="line">  width: calc(25px * 10 + 9px);</span><br><span class="line"></span><br><span class="line">  .items &#123;</span><br><span class="line">    width: 25px;</span><br><span class="line">    height: 25px;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mmm &#123;</span><br><span class="line">  transition: all 0.45s;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>





<blockquote>
<p>new Array和Array.apply(null,{length:81})的区别</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">6</span>)</span><br><span class="line">(<span class="number">6</span>) [空属性 × <span class="number">6</span>]<span class="attr">length</span>: <span class="number">6</span>[[<span class="title class_">Prototype</span>]]: <span class="title class_">Array</span>(<span class="number">0</span>) 只有长度，没有初始化的变量</span><br><span class="line"></span><br><span class="line">&#123;<span class="attr">length</span>:<span class="number">6</span>&#125;</span><br><span class="line">&#123;<span class="attr">length</span>: <span class="number">6</span>&#125;<span class="attr">length</span>: <span class="number">6</span>[[<span class="title class_">Prototype</span>]]: <span class="title class_">Object</span>  </span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">apply</span>(<span class="literal">null</span>,&#123;<span class="attr">length</span>:<span class="number">6</span>&#125;)  初始化了<span class="number">6</span>个空的变量</span><br><span class="line">(<span class="number">6</span>) [<span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>]<span class="number">0</span>: <span class="attr">undefined1</span>: <span class="attr">undefined2</span>: <span class="attr">undefined3</span>: <span class="attr">undefined4</span>: <span class="attr">undefined5</span>: <span class="attr">undefinedlength</span>: <span class="number">6</span>[[<span class="title class_">Prototype</span>]]: <span class="title class_">Array</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">apply</span>(<span class="literal">null</span>,&#123;<span class="attr">length</span>:<span class="number">6</span>&#125;)和<span class="title class_">Array</span>.<span class="title function_">apply</span>(<span class="literal">null</span>,<span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">6</span>))的作用在这里是一样的</span><br></pre></td></tr></table></figure>


</blockquote>
<p><strong>为什么要初始化undefined：</strong></p>
<p>为了可以使用map方法</p>
<p><strong>随机打乱：</strong></p>
<p>使用lodash这个库里面的shuffle函数</p>
<p>代码：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install lodash -S</span><br></pre></td></tr></table></figure>

<p>然后安装ts声明文件库</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install @types/lodash -D</span><br></pre></td></tr></table></figure>

<p>引入：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="状态过度"><a href="#状态过度" class="headerlink" title="状态过度"></a>状态过度</h3><h4 id="例：数字滚动"><a href="#例：数字滚动" class="headerlink" title="例：数字滚动"></a>例：数字滚动</h4><p><img src="https://tu.sunning.fit/i/2022/07/17/62d3a0845e711.png" alt="image-20220717133910953"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;input v-model=&quot;num.current&quot; step=&quot;20&quot; type=&quot;number&quot;&gt;</span><br><span class="line">  &#123;&#123; num.tweenedNumber.toFixed(0) &#125;&#125;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123;reactive, watch&#125; from &quot;vue&quot;;</span><br><span class="line">import gsap from &#x27;gsap&#x27;</span><br><span class="line"></span><br><span class="line">const num = reactive(&#123;</span><br><span class="line">  current: 0,</span><br><span class="line">  tweenedNumber: 0</span><br><span class="line">&#125;)</span><br><span class="line">watch(() =&gt; num.current, (newVal, oldValue) =&gt; &#123;</span><br><span class="line">  gsap.to(num, &#123;</span><br><span class="line">    duration: 1,</span><br><span class="line">    tweenedNumber: newVal</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>





<h1 id="自定义hook函数"><a href="#自定义hook函数" class="headerlink" title="自定义hook函数"></a>自定义hook函数</h1><ul>
<li><p>什么是hook？—— 本质是一个函数，把setup函数中使用的Composition API进行了封装。什么ref,什么computed都用的是hook</p>
</li>
<li><p>类似于vue2.x中的mixin。</p>
</li>
<li><p>自定义hook的优势: 复用代码, 让setup中的逻辑更清楚易懂。</p>
</li>
<li><p>起的名字最好是usexxxx方便别人知道是hook</p>
</li>
<li><p>注意2:hook函数在组件中使用时，相当于函数中的API方法都移动到相关组件中</p>
</li>
</ul>
<p>hook中的生命周期在组件生命周期之前</p>
<p>例子: 在src下面创建hooks,里面创建 useMousePosition</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; onBeforeUnmount, onMounted, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> point = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">    <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">y</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">savePoint</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    point.<span class="property">x</span> = event.<span class="property">pageX</span>;</span><br><span class="line">    point.<span class="property">y</span> = event.<span class="property">pageY</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(point.<span class="property">x</span>, point.<span class="property">y</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, savePoint);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;click&quot;</span>, savePoint);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> point;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后在需要的页面直接使用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">import usePoint from &#x27;../hooks/usePoint&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  setup()&#123;</span><br><span class="line">    let a=usePoint();</span><br><span class="line">    return &#123;</span><br><span class="line">      a  //暴露a</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>







<h1 id="toRef-1"><a href="#toRef-1" class="headerlink" title="toRef"></a>toRef</h1><ul>
<li><p>作用：创建一个 ref 对象，其value值指向另一个对象中的某个属性。</p>
</li>
<li><p>语法：</p>
<p><code>const name = toRef(person,&#39;name&#39;)</code><br>哪个对象，哪个属性</p>
</li>
<li><p>应用:   要将响应式对象中的某个属性单独提供给外部使用时。</p>
</li>
<li><p>扩展：<code>toRefs</code> 与<code>toRef</code>功能一致，但可以批量创建多个 ref 对象，语法：<code>toRefs(person)</code></p>
</li>
</ul>
<p><img src="https://tu.sunning.fit/i/2022/07/06/62c546b355d60.png" alt="image-20220531004616220"></p>
<p>这个不是响应式的，因为给出的name是person.name的值</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">ref</span>(xxx)有响应式，但是原来的数据没有被改变，改变的是由ref生成的新的东西</span><br></pre></td></tr></table></figure>

<p><img src="https://tu.sunning.fit/i/2022/07/06/62c546b609bdd.png" alt="image-20220531010411238"></p>
<p>用…来自动展开对象里面的东西</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span>&#123;</span><br><span class="line">    ...<span class="title function_">toRefs</span>(对象); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tu.sunning.fit/i/2022/07/06/62c546b8dd4f6.png" alt="image-20220531011340264"></p>
<blockquote>
<p>假如后期有个函数，在函数点击后给对象增加一个属性，这时候因为setup只执行一次，…toRefs也只执行一次，一开始没在对象里面的不会被拿出来，这时候只能用折中的方法，把整个对象传出去，调用那个新添加的东西的时候按照原来的方法进行调用</p>
<p><img src="https://tu.sunning.fit/i/2022/07/06/62c546be43033.png" alt="image-20220531012743512"></p>
</blockquote>
<h1 id="其它-Composition-API"><a href="#其它-Composition-API" class="headerlink" title="其它 Composition API"></a>其它 Composition API</h1><h2 id="shallowReactive-与-shallowRef"><a href="#shallowReactive-与-shallowRef" class="headerlink" title="shallowReactive 与 shallowRef"></a>shallowReactive 与 shallowRef</h2><ul>
<li><p>shallowReactive：只处理对象最外层属性的响应式（浅响应式。</p>
</li>
<li><p>shallowRef：只处理基本数据类型的响应式, 不进行对象的响应式处理。</p>
</li>
<li><p>什么时候使用?</p>
<ul>
<li><p>如果有一个对象数据，结构比较深, 但变化时只是外层属性变化 &#x3D;&#x3D;&#x3D;&gt; shallowReactive。</p>
</li>
<li><p>如果有一个<strong>对象数据</strong>，后续功能不会修改该对象中的属性，而是生新的对象来替换 &#x3D;&#x3D;&#x3D;&gt; shallowRef。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;button @click=&#x27;x=&#123;y:888&#125;&#x27;&gt;&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">let x=shallowRef(&#123;</span><br><span class="line">	y:0  //上面把y直接替换了，不考虑y的响应式</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="readonly-与-shallowReadonly"><a href="#readonly-与-shallowReadonly" class="headerlink" title="readonly 与 shallowReadonly"></a>readonly 与 shallowReadonly</h2><ul>
<li>readonly: 让一个响应式数据变为只读的（深只读）。</li>
<li>shallowReadonly：让一个响应式数据变为只读的（浅只读）。</li>
<li>应用场景: 不希望数据被修改时。（用一个别人给的不能改的数据的时候，用一下readonly防止自己误操作了）</li>
</ul>
<h2 id="toRaw-与-markRaw"><a href="#toRaw-与-markRaw" class="headerlink" title="toRaw 与 markRaw"></a>toRaw 与 markRaw</h2><ul>
<li>toRaw：<ul>
<li>作用：将一个由<code>reactive</code>生成的<strong style="color:orange">响应式对象</strong>转为<strong style="color:orange">普通对象</strong>。</li>
<li>使用场景：用于读取响应式对象对应的普通对象，对这个普通对象的所有操作，不会引起页面更新。</li>
</ul>
</li>
<li>markRaw：<ul>
<li>作用：标记一个对象，使其永远不会再成为响应式对象。但是无法使已经被监听的属性摆脱监听</li>
<li>应用场景:<ol>
<li>有些值不应被设置为响应式的，例如复杂的第三方类库等（加入用了别人的库，可能里面嵌套了很多层，而且不准备改变，要用上markRaw）。</li>
<li>当渲染具有不可变数据源的大列表时，跳过响应式转换可以提高性能。</li>
</ol>
</li>
</ul>
</li>
</ul>
<h2 id="customRef-1"><a href="#customRef-1" class="headerlink" title="customRef"></a>customRef</h2><ul>
<li><p>作用：创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制。</p>
</li>
<li><p>ps:js里面函数调用可以在函数定义之前</p>
</li>
<li><p>&#96;&#96;&#96;js<br>return customRef((track,trigger)&#x3D;&gt;{<br>                return{<br>                    get(){<br>                        track() &#x2F;&#x2F;告诉Vue这个value值是需要被“追踪”的<br>                        return value<br>                    },<br>                    set(newValue){<br>                        clearTimeout(timer)<br>                        timer &#x3D; setTimeout(()&#x3D;&gt;{<br>                            value &#x3D; newValue<br>                            trigger() &#x2F;&#x2F;告诉Vue去更新界面<br>                        },delay)<br>                    }<br>                }<br>            })<br>customRef里面需要是一个函数，函数的返回值要是一个对象，这个对象要有get和set方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">- 实现防抖效果：</span><br><span class="line"></span><br><span class="line">  ```vue</span><br><span class="line">  &lt;template&gt;</span><br><span class="line">  	&lt;input type=&quot;text&quot; v-model=&quot;keyword&quot;&gt;</span><br><span class="line">  	&lt;h3&gt;&#123;&#123;keyword&#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;/template&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;script&gt;</span><br><span class="line">  	import &#123;ref,customRef&#125; from &#x27;vue&#x27;</span><br><span class="line">  	export default &#123;</span><br><span class="line">  		name:&#x27;Demo&#x27;,</span><br><span class="line">  		setup()&#123;</span><br><span class="line">  			// let keyword = ref(&#x27;hello&#x27;) //使用Vue准备好的内置ref</span><br><span class="line">  			//自定义一个myRef</span><br><span class="line">  			function myRef(value,delay)&#123;</span><br><span class="line">  				let timer</span><br><span class="line">  				//通过customRef去实现自定义</span><br><span class="line">  				return customRef((track,trigger)=&gt;&#123;</span><br><span class="line">  					return&#123;</span><br><span class="line">  						get()&#123;</span><br><span class="line">  							track() //告诉Vue这个value值是需要被“追踪”的</span><br><span class="line">  							return value</span><br><span class="line">  						&#125;,</span><br><span class="line">  						set(newValue)&#123;</span><br><span class="line">  							clearTimeout(timer)</span><br><span class="line">  							timer = setTimeout(()=&gt;&#123;</span><br><span class="line">  								value = newValue</span><br><span class="line">  								trigger() //告诉Vue去更新界面</span><br><span class="line">  							&#125;,delay)</span><br><span class="line">  						&#125;</span><br><span class="line">  					&#125;</span><br><span class="line">  				&#125;)</span><br><span class="line">  			&#125;</span><br><span class="line">  			let keyword = myRef(&#x27;hello&#x27;,500) //使用程序员自定义的ref</span><br><span class="line">  			return &#123;</span><br><span class="line">  				keyword</span><br><span class="line">  			&#125;</span><br><span class="line">  		&#125;</span><br><span class="line">  	&#125;</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="provide-与-inject"><a href="#provide-与-inject" class="headerlink" title="provide 与 inject"></a>provide 与 inject</h2><img src="https://tu.sunning.fit/i/2022/05/30/6294585271403.png" style="width:300px" />

<ul>
<li><p>作用：实现<strong style="color:#DD5145">祖与后代组件间</strong>通信</p>
</li>
<li><p>套路：父组件有一个 <code>provide</code> 选项来提供数据，后代组件有一个 <code>inject</code> 选项来开始使用这些数据</p>
</li>
<li><p>具体写法：</p>
<ol>
<li><p>祖组件中：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>)&#123;</span><br><span class="line">	......</span><br><span class="line">    <span class="keyword">let</span> car = <span class="title function_">reactive</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;奔驰&#x27;</span>,<span class="attr">price</span>:<span class="string">&#x27;40万&#x27;</span>&#125;)</span><br><span class="line">    <span class="title function_">provide</span>(<span class="string">&#x27;car&#x27;</span>,car)</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>后代组件中：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params">props,context</span>)&#123;</span><br><span class="line">	......</span><br><span class="line">    <span class="keyword">const</span> car = <span class="title function_">inject</span>(<span class="string">&#x27;car&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;car&#125;</span><br><span class="line">	......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h2 id="响应式数据的判断"><a href="#响应式数据的判断" class="headerlink" title="响应式数据的判断"></a>响应式数据的判断</h2><ul>
<li>isRef: 检查一个值是否为一个 ref 对象</li>
<li>isReactive: 检查一个对象是否是由 <code>reactive</code> 创建的响应式代理</li>
<li>isReadonly: 检查一个对象是否是由 <code>readonly</code> 创建的只读代理</li>
<li>isProxy: 检查一个对象是否是由 <code>reactive</code> 或者 <code>readonly</code> 方法创建的代理</li>
</ul>
<h1 id="Composition-API-的优势"><a href="#Composition-API-的优势" class="headerlink" title="Composition API 的优势"></a>Composition API 的优势</h1><p>组合式api发挥自己的功力，就要用好hock函数</p>
<h2 id="Options-API-存在的问题"><a href="#Options-API-存在的问题" class="headerlink" title="Options API 存在的问题"></a>Options API 存在的问题</h2><p>使用传统OptionsAPI中，新增或者修改一个需求，就需要分别在data，methods，computed里修改 。</p>
<div style="width:600px;height:370px;overflow:hidden;float:left">
    <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84e4e2c02424d9a99862ade0a2e4114~tplv-k3u1fbpfcp-watermark.image" style="width:600px;float:left" />
</div>
<div style="width:300px;height:370px;overflow:hidden;float:left">
    <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ac7e20d1784887a826f6360768a368~tplv-k3u1fbpfcp-watermark.image" style="zoom:50%;width:560px;left" /> 
</div>


















<h2 id="Composition-API-的优势-1"><a href="#Composition-API-的优势-1" class="headerlink" title="Composition API 的优势"></a>Composition API 的优势</h2><p>我们可以更加优雅的组织我们的代码，函数。让相关功能的代码更加有序的组织在一起。</p>
<div style="width:500px;height:340px;overflow:hidden;float:left">
    <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc0be8211fc54b6c941c036791ba4efe~tplv-k3u1fbpfcp-watermark.image"style="height:360px"/>
</div>
<div style="width:430px;height:340px;overflow:hidden;float:left">
    <img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cc55165c0e34069a75fe36f8712eb80~tplv-k3u1fbpfcp-watermark.image"style="height:360px"/>
</div>
















<h1 id="新的组件"><a href="#新的组件" class="headerlink" title="新的组件"></a>新的组件</h1><h2 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h2><ul>
<li>在Vue2中: 组件必须有一个根标签</li>
<li>在Vue3中: 组件可以没有根标签, 内部会将多个标签包含在一个Fragment虚拟元素中</li>
<li>好处: 减少标签层级, 减小内存占用</li>
</ul>
<h2 id="Suspense"><a href="#Suspense" class="headerlink" title="Suspense"></a>Suspense</h2><ul>
<li><p>等待异步组件时渲染一些额外内容，让应用有更好的用户体验</p>
</li>
<li><p>使用步骤：</p>
<ul>
<li><p>异步引入组件</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;defineAsyncComponent&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Child</span> = <span class="title function_">defineAsyncComponent</span>(<span class="function">()=&gt;</span><span class="title function_">import</span>(<span class="string">&#x27;./components/Child.vue&#x27;</span>))  <span class="comment">//返回一个import函数，异步引入</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用<code>Suspense</code>包裹组件，并配置好<code>default</code> 与 <code>fallback</code></p>
<p>异步引入组件，加载完成后组件突然出现不好，需要有个占着位置的东西</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div class=&quot;app&quot;&gt;</span><br><span class="line">		&lt;h3&gt;我是App组件&lt;/h3&gt;</span><br><span class="line">		&lt;Suspense&gt;</span><br><span class="line">			&lt;template v-slot:default&gt;  //加载成功之后显示的东西</span><br><span class="line">				&lt;Child/&gt;</span><br><span class="line">			&lt;/template&gt;</span><br><span class="line">			&lt;template v-slot:fallback&gt;   //没有加载成功的时候显示的东西</span><br><span class="line">				&lt;h3&gt;加载中.....&lt;/h3&gt;</span><br><span class="line">			&lt;/template&gt;</span><br><span class="line">		&lt;/Suspense&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>一整个的例子：</p>
<p><strong>Child.vue</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">h3</span>&gt;</span>我是Child组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		&#123;&#123;sum&#125;&#125;</span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">import</span> &#123;ref&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="attr">name</span>:<span class="string">&#x27;Child&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">async</span> <span class="title function_">setup</span>(<span class="params"></span>)&#123;  <span class="comment">//用这种方法也可以起到延迟加载的作用，但是只有这东西用在Suspense里面才行</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="keyword">let</span> sum = <span class="title function_">ref</span>(<span class="number">0</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="keyword">let</span> p = <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				<span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">					<span class="title function_">resolve</span>(&#123;sum&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">				&#125;,<span class="number">3000</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			&#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">			<span class="keyword">return</span> <span class="keyword">await</span> p</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="selector-class">.child</span>&#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">		<span class="attribute">background-color</span>: skyblue;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">		<span class="attribute">padding</span>: <span class="number">10px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>App.vue</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">h3</span>&gt;</span>我是App组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:default</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">				<span class="tag">&lt;<span class="name">Child</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;<span class="name">template</span> <span class="attr">v-slot:fallback</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">				<span class="tag">&lt;<span class="name">h3</span>&gt;</span>稍等，加载中...<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			<span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="comment">// import Child from &#x27;./components/Child&#x27;//静态引入</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">import</span> &#123;defineAsyncComponent&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">const</span> <span class="title class_">Child</span> = <span class="title function_">defineAsyncComponent</span>(<span class="function">()=&gt;</span><span class="title function_">import</span>(<span class="string">&#x27;./components/Child&#x27;</span>)) <span class="comment">//异步引入</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="attr">name</span>:<span class="string">&#x27;App&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="attr">components</span>:&#123;<span class="title class_">Child</span>&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="selector-class">.app</span>&#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">		<span class="attribute">background-color</span>: gray;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">		<span class="attribute">padding</span>: <span class="number">10px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></table></figure>



<h1 id="Setup语法糖"><a href="#Setup语法糖" class="headerlink" title="Setup语法糖"></a>Setup语法糖</h1><p>一个vue文件里面可以有一个无setup的script和一个有setup的script</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="全局API的转移"><a href="#全局API的转移" class="headerlink" title="全局API的转移"></a>全局API的转移</h2><ul>
<li><p>Vue 2.x 有许多全局 API 和配置。</p>
<ul>
<li><p>例如：注册全局组件、注册全局指令等。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注册全局组件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="string">&#x27;MyButton&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">data</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="attr">template</span>: <span class="string">&#x27;&lt;button @click=&quot;count++&quot;&gt;Clicked &#123;&#123; count &#125;&#125; times.&lt;/button&gt;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//注册全局指令</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">directive</span>(<span class="string">&#x27;focus&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">inserted</span>: <span class="function"><span class="params">el</span> =&gt;</span> el.<span class="title function_">focus</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Vue3.0中对这些API做出了调整：</p>
<ul>
<li><p>将全局的API，即：<code>Vue.xxx</code>调整到应用实例（<code>app</code>）上 （因为没有Vue组件了，变成app组件了）</p>
<table>
<thead>
<tr>
<th>2.x 全局 API（<code>Vue</code>）</th>
<th>3.x 实例 API (<code>app</code>)</th>
</tr>
</thead>
<tbody><tr>
<td>Vue.config.xxxx</td>
<td>app.config.xxxx</td>
</tr>
<tr>
<td>Vue.config.productionTip</td>
<td><strong style="color:#DD5145">移除</strong>(因为vue3能自动识别出来是不是在生产环境了)</td>
</tr>
<tr>
<td>Vue.component</td>
<td>app.component</td>
</tr>
<tr>
<td>Vue.directive</td>
<td>app.directive</td>
</tr>
<tr>
<td>Vue.mixin</td>
<td>app.mixin</td>
</tr>
<tr>
<td>Vue.use</td>
<td>app.use</td>
</tr>
<tr>
<td>Vue.prototype（原来放在原型对象上面的东西）</td>
<td>app.config.globalProperties（全局属性）</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
</ul>
<h2 id="其他改变"><a href="#其他改变" class="headerlink" title="其他改变"></a>其他改变</h2><ul>
<li><p>data选项应始终被声明为一个函数。</p>
</li>
<li><p>过度类名的更改：</p>
<ul>
<li><p>Vue2.x写法</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.v-enter</span>,</span><br><span class="line"><span class="selector-class">.v-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.v-leave</span>,</span><br><span class="line"><span class="selector-class">.v-enter-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Vue3.x写法</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.v-enter-from</span>,</span><br><span class="line"><span class="selector-class">.v-leave-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.v-leave-from</span>,</span><br><span class="line"><span class="selector-class">.v-enter-to</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong style="color:#DD5145">移除</strong>keyCode作为 v-on 的修饰符(不能keyup.13了)，同时也不再支持<code>config.keyCodes</code> （Vue.config.keyCodes.huilche&#x3D;13 （定义别名按键））因为这个也是依赖了keyup.13的用法</p>
</li>
<li><p><strong style="color:#DD5145">移除</strong><code>v-on.native</code>修饰符</p>
<ul>
<li><p>父组件中绑定事件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;my-component</span><br><span class="line">  v-on:close=&quot;handleComponentEvent&quot;</span><br><span class="line">  v-on:click=&quot;handleNativeClickEvent&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>子组件中声明自定义事件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    emits: [&#x27;close&#x27;]   //emits: [&#x27;close&#x27;,&#x27;click&#x27;] 如果这样，就把click当作自定义事件，否则都是原生事件 </span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong style="color:#DD5145">移除</strong>过滤器（filter）</p>
<blockquote>
<p>过滤器虽然这看起来很方便，但它需要一个自定义语法，打破大括号内表达式是 “只是 JavaScript” 的假设，这不仅有学习成本，而且有实现成本！建议用方法调用或计算属性去替换过滤器。</p>
</blockquote>
</li>
</ul>
<h1 id="Vue3-2"><a href="#Vue3-2" class="headerlink" title="Vue3.2"></a>Vue3.2</h1><h2 id="script-setup-语法糖"><a href="#script-setup-语法糖" class="headerlink" title="script setup 语法糖"></a>script setup 语法糖</h2><ol>
<li><strong>起初 Vue3.0 暴露变量必须 return 出来，template中才能使用；</strong></li>
<li><strong>Vue3.2 中 只需要在 script 标签上加上</strong> <strong>setup</strong> <strong>属性，组件在编译的过程中代码运行的上下文是在</strong> <strong>setup()</strong> <strong>函数中，无需return，template可直接使用。</strong></li>
</ol>
<h2 id="v-bind在-SFC-标签中启用组件状态驱动的动态-CSS-值"><a href="#v-bind在-SFC-标签中启用组件状态驱动的动态-CSS-值" class="headerlink" title="v-bind在 SFC 标签中启用组件状态驱动的动态 CSS 值"></a>v-bind在 SFC 标签中启用组件状态驱动的动态 CSS 值</h2><p><img src="https://tu.sunning.fit/i/2022/07/06/62c547b04bc9a.png" alt="image-20220531202337581"></p>
<h1 id="异步组件"><a href="#异步组件" class="headerlink" title="异步组件"></a>异步组件</h1><h2 id="异步组件："><a href="#异步组件：" class="headerlink" title="异步组件："></a>异步组件：</h2><p>大型应用中，可能需要将应用分割成小一些的代码块，减少主包的体积,并且只在需要的时候才从服务器加载一个模块</p>
<p>正常的打包：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>

<p>然后在dist目录里面会出现打包完成的文件</p>
<p><img src="https://tu.sunning.fit/i/2022/07/16/62d270cfa52a4.png" alt="image-20220716160319615"></p>
<h3 id="异步组件引入方式"><a href="#异步组件引入方式" class="headerlink" title="异步组件引入方式"></a>异步组件引入方式</h3><p>不能用正常的import方式引入，要用<code>defineAsyncComponent</code>方法引入</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> A = <span class="title function_">defineAsyncComponent</span>(<span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../../components/A/index.vue&#x27;</span>));</span><br></pre></td></tr></table></figure>

<p>但因为是异步组件，还需要用suspense引入加载好的页面，见下面</p>
<h2 id="顶层await"><a href="#顶层await" class="headerlink" title="顶层await"></a>顶层await</h2><p>该特性可以让es模块对外表现为一个async函数，允许es模块去await数据并阻塞其他导入这些数据的模块。只有在数据确定并准备好的时候，导入数据的模块才可以执行相应的代码。</p>
<p>stage3的提案，现在很有好多不支持，不推荐在生产环境中使用</p>
<h3 id="以前的写法pk现在的写法"><a href="#以前的写法pk现在的写法" class="headerlink" title="以前的写法pk现在的写法"></a>以前的写法pk现在的写法</h3><p>在引入顶层 await 之前，如果你试图在一个 <code>async</code> 函数外面使用 <code>await</code> 关键字，将会引起语法错误。为了避免这个问题，开发者通常会使用立即执行函数表达式（IIFE）</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;❤️&#x27;</span>));</span><br><span class="line"><span class="comment">//报错</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line"> <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;❤️&#x27;</span>));</span><br><span class="line">  <span class="comment">//❤️</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h3 id="vue3-2-setup语法糖里"><a href="#vue3-2-setup语法糖里" class="headerlink" title="vue3.2 setup语法糖里"></a>vue3.2 setup语法糖里</h3><p>在setup语法糖里面，可以直接使用顶层await,结果代码会被编译成async setup()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">const post = await fetch(`/api/post/1`).then(r =&gt; r.json())</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h2 id="suspense"><a href="#suspense" class="headerlink" title="suspense"></a>suspense</h2><p><code>&lt;suspense&gt;</code> 组件有两个插槽。它们都只接收一个直接子节点。<code>default</code> 插槽里的节点会尽可能展示出来。如果不能，则展示 <code>fallback</code> 插槽里的节点。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;Suspense&gt;</span><br><span class="line">       &lt;template #default&gt;</span><br><span class="line">           &lt;Dialog&gt;</span><br><span class="line">               &lt;template #default&gt;</span><br><span class="line">                   &lt;A/&gt; //异步加载的组件A</span><br><span class="line">               &lt;/template&gt;</span><br><span class="line">           &lt;/Dialog&gt;</span><br><span class="line">       &lt;/template&gt;</span><br><span class="line">       &lt;template #fallback&gt;</span><br><span class="line">           &lt;div&gt;loading...&lt;/div&gt;  //如果加载失败或者还没加载出来显示的东西</span><br><span class="line">       &lt;/template&gt;</span><br><span class="line">   &lt;/Suspense&gt;</span><br></pre></td></tr></table></figure>



<h1 id="TSX"><a href="#TSX" class="headerlink" title="TSX"></a>TSX</h1><p>安装插件</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install @vitejs/plugin-vue-jsx-D</span><br></pre></td></tr></table></figure>











<h1 id="others"><a href="#others" class="headerlink" title="others"></a>others</h1><h2 id="component-is-切换现实不同的组件"><a href="#component-is-切换现实不同的组件" class="headerlink" title="component :is 切换现实不同的组件"></a>component :is 切换现实不同的组件</h2><p><img src="https://tu.sunning.fit/i/2022/07/06/62c547b510384.png" alt="image-20220531192307005"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Sun wen xiang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/07/21/vue3%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/">http://example.com/2022/07/21/vue3%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">孙文祥的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%89%8D%E7%AB%AF/">前端</a><a class="post-meta__tags" href="/tags/Vue/">Vue</a><a class="post-meta__tags" href="/tags/Vue3/">Vue3</a></div><div class="post_share"><div class="social-share" data-image="https://tu.sunning.fit/i/y/92.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/07/21/%E4%BA%8B%E4%BB%B6/"><img class="prev-cover" src="https://tu.sunning.fit/i/y/50.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">事件</div></div></a></div><div class="next-post pull-right"><a href="/2022/07/21/nodejs/"><img class="next-cover" src="https://tu.sunning.fit/i/y/56.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">nodejs</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/07/21/Axios/" title="Axios"><img class="cover" src="https://tu.sunning.fit/i/y/119.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-21</div><div class="title">Axios</div></div></a></div><div><a href="/2022/07/21/Pinia/" title="Pinia"><img class="cover" src="https://tu.sunning.fit/i/y/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-21</div><div class="title">Pinia</div></div></a></div><div><a href="/2022/07/21/Quasar/" title="Quasar"><img class="cover" src="https://tu.sunning.fit/i/y/26.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-21</div><div class="title">Quasar</div></div></a></div><div><a href="/2022/07/21/Router/" title="Router"><img class="cover" src="https://tu.sunning.fit/i/y/89.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-21</div><div class="title">Router</div></div></a></div><div><a href="/2022/07/21/Vite/" title="Vite"><img class="cover" src="https://tu.sunning.fit/i/y/11.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-21</div><div class="title">Vite</div></div></a></div><div><a href="/2022/07/21/Vuex/" title="Vuex"><img class="cover" src="https://tu.sunning.fit/i/y/60.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-21</div><div class="title">Vuex</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/touxiang.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sun wen xiang</div><div class="author-info__description">遇到困难睡大觉</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">69</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/sunwenxiang133"><i class="fab fa-github"></i><span>Github</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">Vue3简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3%E5%B8%A6%E6%9D%A5%E4%BA%86%E4%BB%80%E4%B9%88"><span class="toc-number">1.2.</span> <span class="toc-text">Vue3带来了什么</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E7%9A%84%E5%8D%87%E7%BA%A7"><span class="toc-number">1.2.1.</span> <span class="toc-text">源码的升级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-number">1.2.2.</span> <span class="toc-text">新的特性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAVue3-0%E5%B7%A5%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">创建Vue3.0工程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-vue-cli-%E5%88%9B%E5%BB%BA"><span class="toc-number">2.1.</span> <span class="toc-text">使用 vue-cli 创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-vite-%E5%88%9B%E5%BB%BA"><span class="toc-number">2.2.</span> <span class="toc-text">使用 vite 创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E5%BC%80%E5%A7%8B"><span class="toc-number">2.3.</span> <span class="toc-text">一开始</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#html-body-app%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-number">2.3.1.</span> <span class="toc-text">html,body,#app的设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#css%E6%B8%85%E9%99%A4%E9%BB%98%E8%AE%A4%E6%A0%B7%E5%BC%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">css清除默认样式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%A5%E7%A8%8B%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">工程结构分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#vue%E6%8C%87%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">vue指令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#v-show-vs-v-if"><span class="toc-number">4.1.</span> <span class="toc-text">v-show vs v-if</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BA%8B%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">@ 添加事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B9%E4%BE%BF%E5%9C%B0%E6%8E%A7%E5%88%B6%E5%93%AA%E4%B8%AAcss%E8%A2%AB%E6%B8%B2%E6%9F%93"><span class="toc-number">4.3.</span> <span class="toc-text">方便地控制哪个css被渲染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#v-model"><span class="toc-number">4.4.</span> <span class="toc-text">v-model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BF%AE%E9%A5%B0%E7%AC%A6%EF%BC%9A"><span class="toc-number">4.4.1.</span> <span class="toc-text">自定义修饰符：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#directive%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4"><span class="toc-number">4.5.</span> <span class="toc-text">directive自定义指令</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8-Composition-API-%E7%BB%84%E5%90%88%E5%BC%8FAPI"><span class="toc-number">5.</span> <span class="toc-text">常用 Composition API (组合式API)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%89%E5%BC%80%E5%BA%8F%E5%B9%95%E7%9A%84setup"><span class="toc-number">5.1.</span> <span class="toc-text">拉开序幕的setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ref%E5%87%BD%E6%95%B0"><span class="toc-number">5.2.</span> <span class="toc-text">ref函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#isRef"><span class="toc-number">5.2.1.</span> <span class="toc-text">isRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowRef"><span class="toc-number">5.2.2.</span> <span class="toc-text">shallowRef</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#shallowRef%E8%A7%86%E5%9B%BE%E6%9B%B4%E6%96%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">5.2.2.1.</span> <span class="toc-text">shallowRef视图更新的问题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#triggerRef"><span class="toc-number">5.2.3.</span> <span class="toc-text">triggerRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#customRef"><span class="toc-number">5.2.4.</span> <span class="toc-text">customRef</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reactive%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.</span> <span class="toc-text">reactive函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%BC%82%E6%AD%A5%E8%B5%8B%E5%80%BC%E9%97%AE%E9%A2%98"><span class="toc-number">5.3.1.</span> <span class="toc-text">数组异步赋值问题</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E4%B8%80"><span class="toc-number">5.3.1.1.</span> <span class="toc-text">解决一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E4%BA%8C"><span class="toc-number">5.3.1.2.</span> <span class="toc-text">解决二</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#readonly"><span class="toc-number">5.3.2.</span> <span class="toc-text">readonly</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shallowReactive"><span class="toc-number">5.3.3.</span> <span class="toc-text">shallowReactive</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#to%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-number">5.4.</span> <span class="toc-text">to全家桶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#toRef"><span class="toc-number">5.4.1.</span> <span class="toc-text">toRef</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRefs"><span class="toc-number">5.4.2.</span> <span class="toc-text">toRefs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toRaw"><span class="toc-number">5.4.3.</span> <span class="toc-text">toRaw</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%E4%B8%8E%E7%9B%91%E8%A7%86"><span class="toc-number">5.5.</span> <span class="toc-text">计算属性与监视</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#computed%E5%87%BD%E6%95%B0"><span class="toc-number">5.5.1.</span> <span class="toc-text">computed函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#watch%E5%87%BD%E6%95%B0"><span class="toc-number">5.5.2.</span> <span class="toc-text">watch函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#watchEffect%E5%87%BD%E6%95%B0"><span class="toc-number">5.5.3.</span> <span class="toc-text">watchEffect函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E5%89%AF%E4%BD%9C%E7%94%A8"><span class="toc-number">5.5.3.1.</span> <span class="toc-text">清除副作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A%E9%85%8D%E7%BD%AE%E9%A1%B9"><span class="toc-number">5.5.3.2.</span> <span class="toc-text">更多配置项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#watchEffect%E8%B0%83%E5%BC%8F"><span class="toc-number">5.5.3.3.</span> <span class="toc-text">watchEffect调式</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%99%9A%E6%8B%9FDOM%E5%92%8Cdiff%E7%AE%97%E6%B3%95"><span class="toc-number">6.</span> <span class="toc-text">虚拟DOM和diff算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9FDOM"><span class="toc-number">6.1.</span> <span class="toc-text">虚拟DOM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Diff%E7%AE%97%E6%B3%95"><span class="toc-number">6.2.</span> <span class="toc-text">Diff算法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue3-0%E4%B8%AD%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">Vue3.0中的响应式原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#vue2-x%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="toc-number">7.1.</span> <span class="toc-text">vue2.x的响应式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue3-0%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F"><span class="toc-number">7.2.</span> <span class="toc-text">Vue3.0的响应式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reactive%E5%AF%B9%E6%AF%94ref"><span class="toc-number">7.3.</span> <span class="toc-text">reactive对比ref</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setup%E7%9A%84%E4%B8%A4%E4%B8%AA%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-number">7.4.</span> <span class="toc-text">setup的两个注意点</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">8.</span> <span class="toc-text">生命周期</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC"><span class="toc-number">9.</span> <span class="toc-text">组件传值</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B6%E5%AD%90%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%80%BC"><span class="toc-number">9.1.</span> <span class="toc-text">父子组件传值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E4%BC%A0%E5%AD%90"><span class="toc-number">9.1.1.</span> <span class="toc-text">父传子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6"><span class="toc-number">9.1.1.1.</span> <span class="toc-text">父</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90"><span class="toc-number">9.1.1.2.</span> <span class="toc-text">子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E4%B8%80%E4%B8%AA%E9%BB%98%E8%AE%A4%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%80%BC"><span class="toc-number">9.1.1.3.</span> <span class="toc-text">设一个默认的对象值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E4%BC%A0%E7%88%B6"><span class="toc-number">9.1.2.</span> <span class="toc-text">子传父</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6-1"><span class="toc-number">9.1.2.1.</span> <span class="toc-text">父</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90-1"><span class="toc-number">9.1.2.2.</span> <span class="toc-text">子</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-Provide-x2F-Inject-vue%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BB%BB%E4%BD%95%E5%9C%B0%E6%96%B9%E9%83%BD%E5%8F%AF%E4%BB%A5%E4%BC%A0%E5%80%BC%E5%92%8C%E8%AF%BB%E5%8F%96%E5%80%BC"><span class="toc-number">9.2.</span> <span class="toc-text">依赖注入(Provide &#x2F; Inject) [vue组件的任何地方都可以传值和读取值]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%84%E5%BC%9F%E7%BB%84%E4%BB%B6%E4%BC%A0%E5%8F%82%E5%92%8CBus"><span class="toc-number">9.3.</span> <span class="toc-text">兄弟组件传参和Bus</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E6%98%AF%E7%88%B6%E5%AD%90"><span class="toc-number">9.3.1.</span> <span class="toc-text">还是父子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%86%99BUS"><span class="toc-number">9.3.2.</span> <span class="toc-text">手写BUS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mitt"><span class="toc-number">9.3.3.</span> <span class="toc-text">Mitt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%89%E8%A3%85"><span class="toc-number">9.3.3.1.</span> <span class="toc-text">1.安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-main-ts-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">9.3.3.2.</span> <span class="toc-text">2.main.ts 初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E6%B4%BE%E5%8F%91%EF%BC%8C%E6%B7%BB%E5%8A%A0%EF%BC%8C%E7%A7%BB%E9%99%A4%EF%BC%8C%E6%B8%85%E7%A9%BA"><span class="toc-number">9.3.3.3.</span> <span class="toc-text">3派发，添加，移除，清空</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">10.</span> <span class="toc-text">组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E7%BB%84%E4%BB%B6"><span class="toc-number">10.1.</span> <span class="toc-text">局部组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E7%BB%84%E4%BB%B6"><span class="toc-number">10.2.</span> <span class="toc-text">全局组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E7%BB%84%E4%BB%B6"><span class="toc-number">10.3.</span> <span class="toc-text">递归组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%BB%84%E4%BB%B6"><span class="toc-number">10.4.</span> <span class="toc-text">动态组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%A0%E9%80%81%E7%BB%84%E4%BB%B6Teleport"><span class="toc-number">10.5.</span> <span class="toc-text">传送组件Teleport</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%93%E5%AD%98%E7%BB%84%E4%BB%B6-keep-alive"><span class="toc-number">10.6.</span> <span class="toc-text">缓存组件(keep-alive)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%9A%84%E5%8F%98%E5%8C%96"><span class="toc-number">10.6.1.</span> <span class="toc-text">生命周期的变化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#include-%E5%92%8C-exclude%E5%92%8Cmax"><span class="toc-number">10.6.2.</span> <span class="toc-text">include 和 exclude和max</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8F%92%E6%A7%BD"><span class="toc-number">11.</span> <span class="toc-text">插槽</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E6%8F%92%E6%A7%BD"><span class="toc-number">11.1.</span> <span class="toc-text">匿名插槽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E5%90%8D%E6%8F%92%E6%A7%BD"><span class="toc-number">11.2.</span> <span class="toc-text">具名插槽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%8F%92%E6%A7%BD"><span class="toc-number">11.3.</span> <span class="toc-text">作用域插槽</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E6%8F%92%E6%A7%BD"><span class="toc-number">11.4.</span> <span class="toc-text">动态插槽</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A8%E7%94%BB"><span class="toc-number">12.</span> <span class="toc-text">动画</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E4%B8%AAclass%E7%B1%BB"><span class="toc-number">12.1.</span> <span class="toc-text">6个class类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E5%BA%A6class%E7%B1%BB%E5%90%8D"><span class="toc-number">12.2.</span> <span class="toc-text">自定义过度class类名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#transition%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F8%E4%B8%AA"><span class="toc-number">12.3.</span> <span class="toc-text">transition生命周期8个</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Appear%E5%B1%9E%E6%80%A7"><span class="toc-number">12.4.</span> <span class="toc-text">Appear属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Transition-group%E8%BF%87%E5%BA%A6%E5%88%97%E8%A1%A8"><span class="toc-number">12.5.</span> <span class="toc-text">Transition-group过度列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E5%85%A5%E7%A6%BB%E5%BC%80%E8%BF%87%E5%BA%A6"><span class="toc-number">12.5.1.</span> <span class="toc-text">进入离开过度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E8%BF%87%E6%B8%A1"><span class="toc-number">12.5.2.</span> <span class="toc-text">移动过渡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%EF%BC%9A%E5%B9%B3%E7%A7%BB%E7%9A%84%E6%95%B0%E5%AD%97"><span class="toc-number">12.5.2.1.</span> <span class="toc-text">例：平移的数字</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E8%BF%87%E5%BA%A6"><span class="toc-number">12.5.3.</span> <span class="toc-text">状态过度</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%EF%BC%9A%E6%95%B0%E5%AD%97%E6%BB%9A%E5%8A%A8"><span class="toc-number">12.5.3.1.</span> <span class="toc-text">例：数字滚动</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89hook%E5%87%BD%E6%95%B0"><span class="toc-number">13.</span> <span class="toc-text">自定义hook函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#toRef-1"><span class="toc-number">14.</span> <span class="toc-text">toRef</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E5%AE%83-Composition-API"><span class="toc-number">15.</span> <span class="toc-text">其它 Composition API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#shallowReactive-%E4%B8%8E-shallowRef"><span class="toc-number">15.1.</span> <span class="toc-text">shallowReactive 与 shallowRef</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#readonly-%E4%B8%8E-shallowReadonly"><span class="toc-number">15.2.</span> <span class="toc-text">readonly 与 shallowReadonly</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#toRaw-%E4%B8%8E-markRaw"><span class="toc-number">15.3.</span> <span class="toc-text">toRaw 与 markRaw</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#customRef-1"><span class="toc-number">15.4.</span> <span class="toc-text">customRef</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#provide-%E4%B8%8E-inject"><span class="toc-number">15.5.</span> <span class="toc-text">provide 与 inject</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE%E7%9A%84%E5%88%A4%E6%96%AD"><span class="toc-number">15.6.</span> <span class="toc-text">响应式数据的判断</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Composition-API-%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">16.</span> <span class="toc-text">Composition API 的优势</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Options-API-%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">16.1.</span> <span class="toc-text">Options API 存在的问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Composition-API-%E7%9A%84%E4%BC%98%E5%8A%BF-1"><span class="toc-number">16.2.</span> <span class="toc-text">Composition API 的优势</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%B0%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-number">17.</span> <span class="toc-text">新的组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Fragment"><span class="toc-number">17.1.</span> <span class="toc-text">Fragment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Suspense"><span class="toc-number">17.2.</span> <span class="toc-text">Suspense</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Setup%E8%AF%AD%E6%B3%95%E7%B3%96"><span class="toc-number">18.</span> <span class="toc-text">Setup语法糖</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">19.</span> <span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80API%E7%9A%84%E8%BD%AC%E7%A7%BB"><span class="toc-number">19.1.</span> <span class="toc-text">全局API的转移</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%94%B9%E5%8F%98"><span class="toc-number">19.2.</span> <span class="toc-text">其他改变</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Vue3-2"><span class="toc-number">20.</span> <span class="toc-text">Vue3.2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#script-setup-%E8%AF%AD%E6%B3%95%E7%B3%96"><span class="toc-number">20.1.</span> <span class="toc-text">script setup 语法糖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#v-bind%E5%9C%A8-SFC-%E6%A0%87%E7%AD%BE%E4%B8%AD%E5%90%AF%E7%94%A8%E7%BB%84%E4%BB%B6%E7%8A%B6%E6%80%81%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%8A%A8%E6%80%81-CSS-%E5%80%BC"><span class="toc-number">20.2.</span> <span class="toc-text">v-bind在 SFC 标签中启用组件状态驱动的动态 CSS 值</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6"><span class="toc-number">21.</span> <span class="toc-text">异步组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6%EF%BC%9A"><span class="toc-number">21.1.</span> <span class="toc-text">异步组件：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E7%BB%84%E4%BB%B6%E5%BC%95%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">21.1.1.</span> <span class="toc-text">异步组件引入方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B6%E5%B1%82await"><span class="toc-number">21.2.</span> <span class="toc-text">顶层await</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E5%89%8D%E7%9A%84%E5%86%99%E6%B3%95pk%E7%8E%B0%E5%9C%A8%E7%9A%84%E5%86%99%E6%B3%95"><span class="toc-number">21.2.1.</span> <span class="toc-text">以前的写法pk现在的写法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vue3-2-setup%E8%AF%AD%E6%B3%95%E7%B3%96%E9%87%8C"><span class="toc-number">21.2.2.</span> <span class="toc-text">vue3.2 setup语法糖里</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#suspense"><span class="toc-number">21.3.</span> <span class="toc-text">suspense</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TSX"><span class="toc-number">22.</span> <span class="toc-text">TSX</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#others"><span class="toc-number">23.</span> <span class="toc-text">others</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#component-is-%E5%88%87%E6%8D%A2%E7%8E%B0%E5%AE%9E%E4%B8%8D%E5%90%8C%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-number">23.1.</span> <span class="toc-text">component :is 切换现实不同的组件</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/21/Axios/" title="Axios"><img src="https://tu.sunning.fit/i/y/119.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Axios"/></a><div class="content"><a class="title" href="/2022/07/21/Axios/" title="Axios">Axios</a><time datetime="2022-07-21T00:43:02.000Z" title="发表于 2022-07-21 08:43:02">2022-07-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/21/BFS/" title="BFS"><img src="https://tu.sunning.fit/i/y/46.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BFS"/></a><div class="content"><a class="title" href="/2022/07/21/BFS/" title="BFS">BFS</a><time datetime="2022-07-21T00:43:02.000Z" title="发表于 2022-07-21 08:43:02">2022-07-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/21/BOM/" title="BOM"><img src="https://tu.sunning.fit/i/y/70.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BOM"/></a><div class="content"><a class="title" href="/2022/07/21/BOM/" title="BOM">BOM</a><time datetime="2022-07-21T00:43:02.000Z" title="发表于 2022-07-21 08:43:02">2022-07-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/21/Clion%E4%BD%BF%E7%94%A8/" title="Clion使用"><img src="https://tu.sunning.fit/i/y/18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Clion使用"/></a><div class="content"><a class="title" href="/2022/07/21/Clion%E4%BD%BF%E7%94%A8/" title="Clion使用">Clion使用</a><time datetime="2022-07-21T00:43:02.000Z" title="发表于 2022-07-21 08:43:02">2022-07-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/07/21/DFS/" title="DFS"><img src="https://tu.sunning.fit/i/y/88.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DFS"/></a><div class="content"><a class="title" href="/2022/07/21/DFS/" title="DFS">DFS</a><time datetime="2022-07-21T00:43:02.000Z" title="发表于 2022-07-21 08:43:02">2022-07-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Sun wen xiang</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>